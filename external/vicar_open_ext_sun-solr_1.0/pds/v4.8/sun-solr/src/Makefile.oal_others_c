# This Makefile makes a library file (.a file) containing all the OA and L3
# object code compiled with C++.
#
# This makefile assumes that the following directories exist:
# source/lablib3 - contains the source code for lablib3
# source/oal - contains the source code for oal
# lib - contains finished libraries
#
# The library will combine OAL and LABLIB3 in one library named liboal_others_cpp.a
# and will be placed in the lib directory.
#
# Depending on the platform you're compiling on, you need to include the
# correct .def file below:
#
#   Sun Sparc/SunOS and Solaris:      sun.nonansi.def or sun.sparc.def
#
# Change this line as needed
#include sgi.iris.def

OAL_SOURCE_LIB = oal
LABLIB3_SOURCE_LIB = lablib3

include $(OAL_SOURCE_LIB)/sun_sparc.def


FLAGS = -DSUN_UNIX -DSUN4
CC = gcc

#This specifies the path to the XVT directory.
INC_PATH = -I$(OAL_SOURCE_LIB) -I$(LABLIB3_SOURCE_LIB)

LIB_OBJS = $(OAL_SOURCE_LIB)/binrep.o $(OAL_SOURCE_LIB)/clmdcmp1.o $(OAL_SOURCE_LIB)/clmdcmp2.o \
           $(OAL_SOURCE_LIB)/decomp.o $(OAL_SOURCE_LIB)/oal.o  $(OAL_SOURCE_LIB)/oamalloc.o \
           $(OAL_SOURCE_LIB)/obj_l1.o $(OAL_SOURCE_LIB)/obj_l2.o $(OAL_SOURCE_LIB)/odlutils.o  \
           $(OAL_SOURCE_LIB)/rprt_err.o  $(OAL_SOURCE_LIB)/stream_l.o  $(OAL_SOURCE_LIB)/struct_l.o\
           $(OAL_SOURCE_LIB)/writegif.o $(OAL_SOURCE_LIB)/oa_gif.o $(LABLIB3_SOURCE_LIB)/lablib3.o

INCS	 = $(OAL_SOURCE_LIB)/binrep.h  $(OAL_SOURCE_LIB)/jpeg_c.h  $(OAL_SOURCE_LIB)/oal.h  \
           $(OAL_SOURCE_LIB)/oal_sys.h  $(OAL_SOURCE_LIB)/oamalloc.h  $(OAL_SOURCE_LIB)/odlutils.h \
           $(OAL_SOURCE_LIB)/stream_l.h $(OAL_SOURCE_LIB)/toolbox.h $(LABLIB3_SOURCE_LIB)/lablib3.h

all: lib/liboal_others_cpp.a

lib/liboal_others_cpp.a: $(LIB_OBJS)
	ar -rv lib/liboal_others_c.a $(LIB_OBJS)

$(LIB_OBJS):  $(INCS)
	$(CC) -g $(FLAGS) $(INC_PATH) -c $*.c -o $*.o

clean:
	@echo "cleaning"
	rm $(OAL_SOURCE_LIB)/*.o $(LABLIB3_SOURCE_LIB)/*.o
	rm -f lib/liboal_others_c.a $(LIB_OBJS)








