$!****************************************************************************
$!
$! Build proc for MIPL module gllpsf
$! VPACK Version 1.9, Thursday, March 17, 2011, 16:32:12
$!
$! Execute by entering:		$ @gllpsf
$!
$! The primary option controls how much is to be built.  It must be in
$! the first parameter.  Only the capitalized letters below are necessary.
$!
$! Primary options are:
$!   COMPile     Compile the program modules
$!   ALL         Build a private version, and unpack the PDF and DOC files.
$!   STD         Build a private version, and unpack the PDF file(s).
$!   SYStem      Build the system version with the CLEAN option, and
$!               unpack the PDF and DOC files.
$!   CLEAN       Clean (delete/purge) parts of the code, see secondary options
$!   UNPACK      All files are created.
$!   REPACK      Only the repack file is created.
$!   SOURCE      Only the source files are created.
$!   SORC        Only the source files are created.
$!               (This parameter is left in for backward compatibility).
$!   PDF         Only the PDF file is created.
$!   TEST        Only the test files are created.
$!   IMAKE       Only the IMAKE file (used with the VIMAKE program) is created.
$!
$!   The default is to use the STD parameter if none is provided.
$!
$!****************************************************************************
$!
$! The secondary options modify how the primary option is performed.
$! Note that secondary options apply to particular primary options,
$! listed below.  If more than one secondary is desired, separate them by
$! commas so the entire list is in a single parameter.
$!
$! Secondary options are:
$! COMPile,ALL:
$!   DEBug      Compile for debug               (/debug/noopt)
$!   PROfile    Compile for PCA                 (/debug)
$!   LISt       Generate a list file            (/list)
$!   LISTALL    Generate a full list            (/show=all)   (implies LIST)
$! CLEAN:
$!   OBJ        Delete object and list files, and purge executable (default)
$!   SRC        Delete source and make files
$!
$!****************************************************************************
$!
$ write sys$output "*** module gllpsf ***"
$!
$ Create_Source = ""
$ Create_Repack =""
$ Create_PDF = ""
$ Create_Test = ""
$ Create_Imake = ""
$ Do_Make = ""
$!
$! Parse the primary option, which must be in p1.
$ primary = f$edit(p1,"UPCASE,TRIM")
$ if (primary.eqs."") then primary = " "
$ secondary = f$edit(p2,"UPCASE,TRIM")
$!
$ if primary .eqs. "UNPACK" then gosub Set_Unpack_Options
$ if (f$locate("COMP", primary) .eqs. 0) then gosub Set_Exe_Options
$ if (f$locate("ALL", primary) .eqs. 0) then gosub Set_All_Options
$ if (f$locate("STD", primary) .eqs. 0) then gosub Set_Default_Options
$ if (f$locate("SYS", primary) .eqs. 0) then gosub Set_Sys_Options
$ if primary .eqs. " " then gosub Set_Default_Options
$ if primary .eqs. "REPACK" then Create_Repack = "Y"
$ if primary .eqs. "SORC" .or. primary .eqs. "SOURCE" then Create_Source = "Y"
$ if primary .eqs. "PDF" then Create_PDF = "Y"
$ if primary .eqs. "TEST" then Create_Test = "Y"
$ if primary .eqs. "IMAKE" then Create_Imake = "Y"
$ if (f$locate("CLEAN", primary) .eqs. 0) then Do_Make = "Y"
$!
$ if (Create_Source .or. Create_Repack .or. Create_PDF .or. Create_Test .or -
        Create_Imake .or. Do_Make) -
        then goto Parameter_Okay
$ write sys$output "Invalid argument given to gllpsf.com file -- ", primary
$ write sys$output "For a list of valid arguments, please see the header of"
$ write sys$output "of this .com file."
$ exit
$!
$Parameter_Okay:
$ if Create_Repack then gosub Repack_File
$ if Create_Source then gosub Source_File
$ if Create_PDF then gosub PDF_File
$ if Create_Test then gosub Test_File
$ if Create_Imake then gosub Imake_File
$ if Do_Make then gosub Run_Make_File
$ exit
$!
$ Set_Unpack_Options:
$   Create_Repack = "Y"
$   Create_Source = "Y"
$   Create_PDF = "Y"
$   Create_Test = "Y"
$   Create_Imake = "Y"
$ Return
$!
$ Set_EXE_Options:
$   Create_Source = "Y"
$   Create_Imake = "Y"
$   Do_Make = "Y"
$ Return
$!
$ Set_Default_Options:
$   Create_Source = "Y"
$   Create_Imake = "Y"
$   Do_Make = "Y"
$   Create_PDF = "Y"
$ Return
$!
$ Set_All_Options:
$   Create_Source = "Y"
$   Create_Imake = "Y"
$   Do_Make = "Y"
$   Create_PDF = "Y"
$ Return
$!
$ Set_Sys_Options:
$   Create_Source = "Y"
$   Create_Imake = "Y"
$   Create_PDF = "Y"
$   Do_Make = "Y"
$ Return
$!
$Run_Make_File:
$   if F$SEARCH("gllpsf.imake") .nes. ""
$   then
$      vimake gllpsf
$      purge gllpsf.bld
$   else
$      if F$SEARCH("gllpsf.bld") .eqs. ""
$      then
$         gosub Imake_File
$         vimake gllpsf
$      else
$      endif
$   endif
$   if (primary .eqs. " ")
$   then
$      @gllpsf.bld "STD"
$   else
$      @gllpsf.bld "''primary'" "''secondary'"
$   endif
$ Return
$!#############################################################################
$Repack_File:
$ create gllpsf.repack
$ DECK/DOLLARS="$ VOKAGLEVE"
$ vpack gllpsf.com -mixed -
	-s gllpsf.f -
	-i gllpsf.imake -
	-p gllpsf.pdf -
	-t tstgllpsf.pdf tstgllpsf.log_solos tstgllpsf.log_linux
$ Exit
$ VOKAGLEVE
$ Return
$!#############################################################################
$Source_File:
$ create gllpsf.f
$ DECK/DOLLARS="$ VOKAGLEVE"
c 17 JUN 96 OAM...... Included additional valid filter values to make
c                     program compatible with SAGE.
c 8  MAR 96 OAM/HBM   Added PSF values for other GLL filters
c 31 OCT 94 ...CRI... MSTP S/W CONVERSION (VICAR PORTING)
c
      include 'VICMAIN_FOR'
      subroutine main44

      integer*4 count,def,ounit,index,nl,ns
    
      character*80 msg
      character*7 filt
      real*4 buf(4096),psf(2,191),psfca(129),psfcb(129)
c    UNIX has a low limit on continuation lines
      equivalence (psf,psfca),(psf(2,65),psfcb)
c    distance (pixels)    attenuation coefficient (per source pixel)
      data psfca/
     +    0.1, 0.475,    0.2,  0.44,     0.3,  0.4,      0.4,  0.365,
     +    0.5, 0.34,     0.6,  0.28,     0.7,  0.23,     0.8,  0.19,
     +    0.9, 0.14,     1,    0.098,    1.1,  0.074,    1.2,  0.052,
     +    1.3, 0.035,    1.4,  0.02,     1.5,  0.012,    1.6,  0.005,
     +    1.7, 0.0022,   1.8,  0.0012,   1.9,  0.00083,  2,    0.000642,
     +    2.5, 0.00044,  3,    0.00034,  3.5,  0.00027,  4,    0.00022,
     +    4.5, 0.00018,  5,    0.00015,  5.5,  0.00013,  6,    0.00011,
     +    6.5, 9.2E-05,  7,    8E-05,    7.5,  6.7E-05,  8,    5.8E-05,
     +    8.5, 5E-05,    9,    4.4E-05,  9.5,  3.8E-05,  10,   3.4E-05,
     +   10.5, 3.3E-05,  11,   2.9E-05,  11.5, 2.6E-05,  12,   2.4E-05,
     +   12.5, 2.3E-05,  13,   2.1E-05,  13.5, 2E-05,    14,   1.9E-05,
     +   14.5, 1.7E-05,  15,   1.6E-05,  15.5, 1.45E-05, 16,   1.3E-05,
     +   16.5, 1.15E-05, 17,   1.05E-05, 17.5, 9.6E-06,  18,   8.7E-06,
     +   18.5, 8E-06,    19,   7.6E-06,  19.5, 6.9E-06,  20,   6.4E-06,
     +   30,   2.4E-06,  40,   1.3E-06,  50,   8.2E-07,  60,   5.2E-07,
     +   70,   3.5E-07,  80,   2.4E-07,  90,   1.7E-07,  100,  1.3E-07,
     +  110/
        data psfcb/
     +   1E-07,    120,  8.5E-08,  130,  7.2E-08,  140,  6.1E-08,
     +   150,  5.2E-08,  160,  4.4E-08,  170,  4E-08,    180,  3.4E-08,
     +   190,  3.1E-08,  200,  2.9E-08,  220,  2.4E-08,  240,  2E-08,
     +   260,  1.7E-08,  280,  1.4E-08,  300,  1.2E-08,  320,  1E-08,
     +   340,  8.5E-09,  360,  7.4E-09,  380,  6.4E-09,  400,  5.5E-09,
     +   420,  5E-09,    440,  4.4E-09,  460,  4.1E-09,  480,  3.9E-09,
     +   500,  3.6E-09,  520,  3.4E-09,  540,  3.2E-09,  560,  3.1E-09,
     +   580,  2.9E-09,  600,  2.9E-09,  620,  3.5E-09,  640,  4.55E-09,
     +   660,  6E-09,    680,  8E-09,    700,  9.5E-09,  720,  1.1E-08,
     +   740,  1.2E-08,  760,  1.3E-08,  780,  1.5E-08,  800,  1.55E-08,
     +   820,  1.6E-08,  840,  1.6E-08,  860,  1.55E-08, 880,  1.4E-08,
     +   900,  1.2E-08,  920,  1.1E-08,  940,  9.4E-09,  960,  8E-09,
     +   980,  6.5E-09,  1000, 5.2E-09,  1020, 4.3E-09,  1040, 3.5E-09,
     +   1060, 2.9E-09,  1080, 2.3E-09,  1100, 2E-09,    1745, 3.6E-10,
     +   2618, 3.03E-11, 3491, 2.86E-11, 4363, 1.8E-11,  5236, 7.18E-12,
     +   6109, 5.08E-12, 6981, 4.28E-12, 7854, 3.03E-12, 8727, 2.86E-12,
     +   9599, 1.8E-12  /

         real*4 psfgrna(192), psfgrnb(190)  !Added additional filters-OAM
         data psfgrna/
     +   .00000000E+00, .83430000E+00,
     +   .10000000E+00, .81370000E+00, .20000000E+00, .76220000E+00,
     +   .30000000E+00, .67980000E+00, .40000000E+00, .58710000E+00,
     +   .50000000E+00, .45320000E+00, .60000000E+00, .37080000E+00,
     +   .70000000E+00, .24720000E+00, .80000010E+00, .17510000E+00,
     +   .90000010E+00, .11330000E+00, .10000000E+01, .63860000E-01,
     +   .11000000E+01, .41200000E-01, .12000000E+01, .22660000E-01,
     +   .13000000E+01, .11330000E-01, .14000000E+01, .52530000E-02,
     +   .15000000E+01, .26780000E-02, .16000000E+01, .11330000E-02,
     +   .17000000E+01, .13390000E-03, .18000000E+01, .67980000E-04,
     +   .19000000E+01, .46350000E-04, .20000000E+01, .36050000E-04,
     +   .25000000E+01, .25750000E-04, .30000000E+01, .22660000E-04,
     +   .35000000E+01, .20600000E-04, .40000000E+01, .18540000E-04,
     +   .45000000E+01, .17510000E-04, .50000000E+01, .16480000E-04,
     +   .55000000E+01, .15450000E-04, .60000000E+01, .14420000E-04,
     +   .65000000E+01, .14420000E-04, .70000000E+01, .13390000E-04,
     +   .75000000E+01, .13390000E-04, .80000000E+01, .12360000E-04,
     +   .85000000E+01, .11330000E-04, .90000000E+01, .11330000E-04,
     +   .95000000E+01, .10300000E-04, .10000000E+02, .10197000E-04,
     +   .10500000E+02, .98880000E-05, .11000000E+02, .94760000E-05,
     +   .11500000E+02, .91670000E-05, .12000000E+02, .88580000E-05,
     +   .12500000E+02, .85490000E-05, .13000000E+02, .82400000E-05,
     +   .13500000E+02, .80340000E-05, .14000000E+02, .78280000E-05,
     +   .14500000E+02, .76220000E-05, .15000000E+02, .74160000E-05,
     +   .15500000E+02, .71070000E-05, .16000000E+02, .69010000E-05,
     +   .16500000E+02, .66950000E-05, .17000000E+02, .64890000E-05,
     +   .17500000E+02, .62830000E-05, .18000000E+02, .61800000E-05,
     +   .18500000E+02, .59740000E-05, .19000000E+02, .57680000E-05,
     +   .19500000E+02, .56650000E-05, .20000000E+02, .55620000E-05,
     +   .21000000E+02, .52530000E-05, .22000000E+02, .50470000E-05,
     +   .23000000E+02, .47380000E-05, .24000000E+02, .44290000E-05,
     +   .25000000E+02, .41200000E-05, .26000000E+02, .39140000E-05,
     +   .27000000E+02, .36050000E-05, .28000000E+02, .33990000E-05,
     +   .29000000E+02, .32960000E-05, .30000000E+02, .30900000E-05,
     +   .31000000E+02, .28840000E-05, .32000000E+02, .26780000E-05,
     +   .33000000E+02, .24720000E-05, .34000000E+02, .23690000E-05,
     +   .35000000E+02, .21630000E-05, .36000000E+02, .19570000E-05,
     +   .37000000E+02, .17510000E-05, .38000000E+02, .16480000E-05,
     +   .39000000E+02, .15450000E-05, .40000000E+02, .14420000E-05,
     +   .50000000E+02, .67980000E-06, .60000000E+02, .43260000E-06,
     +   .70000000E+02, .29870000E-06, .80000000E+02, .24720000E-06,
     +   .90000000E+02, .21630000E-06, .10000000E+03, .18540000E-06,
     +   .11000000E+03, .17510000E-06, .12000000E+03, .16480000E-06,
     +   .13000000E+03, .15450000E-06, .14000000E+03, .15450000E-06,
     +   .15000000E+03, .14420000E-06, .16000000E+03, .14420000E-06,
     +   .17000000E+03, .13390000E-06, .18000000E+03, .13390000E-06,
     +   .19000000E+03, .13390000E-06, .20000000E+03, .13390000E-06,
     +   .22000000E+03, .10300000E-06, .24000000E+03, .65920000E-07,
     +   .26000000E+03, .52530000E-07 / 
     
          data psfgrnb/
     +   .28000000E+03, .29870000E-07,
     +   .30000000E+03, .23690000E-07, .32000000E+03, .19570000E-07,
     +   .34000000E+03, .16480000E-07, .36000000E+03, .14420000E-07,
     +   .38000000E+03, .12360000E-07, .40000000E+03, .11330000E-07,
     +   .42000000E+03, .10300000E-07, .44000000E+03, .97849990E-08,
     +   .46000000E+03, .93730000E-08, .48000000E+03, .90639990E-08,
     +   .50000000E+03, .88580000E-08, .52000000E+03, .86520000E-08,
     +   .54000000E+03, .84459990E-08, .56000000E+03, .83430000E-08,
     +   .58000000E+03, .82400000E-08, .60000000E+03, .81370000E-08,
     +   .62000000E+03, .81370000E-08, .64000000E+03, .81370000E-08,
     +   .66000000E+03, .81370000E-08, .68000000E+03, .82400000E-08,
     +   .70000000E+03, .82400000E-08, .72000000E+03, .84459990E-08,
     +   .74000000E+03, .86520000E-08, .76000000E+03, .88580000E-08,
     +   .78000000E+03, .90639990E-08, .80000000E+03, .92700000E-08,
     +   .82000000E+03, .90639990E-08, .84000000E+03, .88580000E-08,
     +   .86000000E+03, .86520000E-08, .88000000E+03, .82400000E-08,
     +   .90000000E+03, .74160000E-08, .92000000E+03, .63860000E-08,
     +   .94000000E+03, .57680000E-08, .96000000E+03, .52530000E-08,
     +   .98000000E+03, .48410000E-08, .10000000E+04, .44290000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10, .30000000E+04, .29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /



         real*4 psfreda(192), psfredb(190)      
         data psfreda /
     +   .00000000E+00, .69010000E+00,
     +   .10000000E+00, .64890000E+00, .20000000E+00, .59740000E+00,
     +   .30000000E+00, .53560000E+00, .40000000E+00, .47380000E+00,
     +   .50000000E+00, .41200000E+00, .60000000E+00, .35020000E+00,
     +   .70000000E+00, .25750000E+00, .80000010E+00, .18540000E+00,
     +   .90000010E+00, .12360000E+00, .10000000E+01, .84460000E-01,
     +   .11000000E+01, .56650000E-01, .12000000E+01, .35020000E-01,
     +   .13000000E+01, .19570000E-01, .14000000E+01, .11330000E-01,
     +   .15000000E+01, .60770000E-02, .16000000E+01, .30900000E-02,
     +   .17000000E+01, .11330000E-02, .18000000E+01, .36050000E-03,
     +   .19000000E+01, .20600000E-03, .20000000E+01, .15450000E-03,
     +   .25000000E+01, .11330000E-03, .30000000E+01, .92700000E-04,
     +   .35000000E+01, .78280000E-04, .40000000E+01, .64889990E-04,
     +   .45000000E+01, .55620000E-04, .50000000E+01, .48410000E-04,
     +   .55000000E+01, .41200000E-04, .60000000E+01, .37080000E-04,
     +   .65000000E+01, .32960000E-04, .70000000E+01, .28840000E-04,
     +   .75000000E+01, .26780000E-04, .80000000E+01, .24720000E-04,
     +   .85000000E+01, .22660000E-04, .90000000E+01, .20600000E-04,
     +   .95000000E+01, .18540000E-04, .10000000E+02, .17510000E-04,
     +   .10500000E+02, .16480000E-04, .11000000E+02, .15450000E-04,
     +   .11500000E+02, .14420000E-04, .12000000E+02, .13390000E-04,
     +   .12500000E+02, .12360000E-04, .13000000E+02, .11330000E-04,
     +   .13500000E+02, .10300000E-04, .14000000E+02, .97850000E-05,
     +   .14500000E+02, .90640000E-05, .15000000E+02, .83430000E-05,
     +   .15500000E+02, .78280000E-05, .16000000E+02, .74160000E-05,
     +   .16500000E+02, .70040000E-05, .17000000E+02, .66950000E-05,
     +   .17500000E+02, .61800000E-05, .18000000E+02, .59740000E-05,
     +   .18500000E+02, .56650000E-05, .19000000E+02, .53560000E-05,
     +   .19500000E+02, .51500000E-05, .20000000E+02, .49440000E-05,
     +   .21000000E+02, .44290000E-05, .22000000E+02, .40170000E-05,
     +   .23000000E+02, .38110000E-05, .24000000E+02, .35020000E-05,
     +   .25000000E+02, .32960000E-05, .26000000E+02, .30900000E-05,
     +   .27000000E+02, .29870000E-05, .28000000E+02, .28840000E-05,
     +   .29000000E+02, .27810000E-05, .30000000E+02, .26780000E-05,
     +   .31000000E+02, .25750000E-05, .32000000E+02, .24720000E-05,
     +   .33000000E+02, .24720000E-05, .34000000E+02, .23690000E-05,
     +   .35000000E+02, .22660000E-05, .36000000E+02, .21630000E-05,
     +   .37000000E+02, .21630000E-05, .38000000E+02, .20600000E-05,
     +   .39000000E+02, .20600000E-05, .40000000E+02, .19570000E-05,
     +   .50000000E+02, .11330000E-05, .60000000E+02, .75190000E-06,
     +   .70000000E+02, .55620000E-06, .80000000E+02, .41200000E-06,
     +   .90000000E+02, .35020000E-06, .10000000E+03, .28840000E-06,
     +   .11000000E+03, .24720000E-06, .12000000E+03, .21630000E-06,
     +   .13000000E+03, .19570000E-06, .14000000E+03, .17510000E-06,
     +   .15000000E+03, .16480000E-06, .16000000E+03, .15450000E-06,
     +   .17000000E+03, .14420000E-06, .18000000E+03, .14420000E-06,
     +   .19000000E+03, .13390000E-06, .20000000E+03, .13390000E-06,
     +   .22000000E+03, .11330000E-06, .24000000E+03, .92700000E-07,
     +   .26000000E+03,  .79310000E-07/

	 data psfredb/
     +   .28000000E+03, .65920000E-07,
     +   .30000000E+03, .57680000E-07, .32000000E+03, .49440000E-07,
     +   .34000000E+03, .43260000E-07, .36000000E+03, .38110000E-07,
     +   .38000000E+03, .33990000E-07, .40000000E+03, .30900000E-07,
     +   .42000000E+03, .26780000E-07, .44000000E+03, .24720000E-07,
     +   .46000000E+03, .21630000E-07, .48000000E+03, .20600000E-07,
     +   .50000000E+03, .18540000E-07, .52000000E+03, .17510000E-07,
     +   .54000000E+03, .16480000E-07, .56000000E+03, .15965000E-07,
     +   .58000000E+03, .15450000E-07, .60000000E+03, .15450000E-07,
     +   .62000000E+03, .14935000E-07, .64000000E+03, .14729000E-07,
     +   .66000000E+03, .14420000E-07, .68000000E+03, .13596000E-07,
     +   .70000000E+03, .12566000E-07, .72000000E+03, .11536000E-07,
     +   .74000000E+03, .99910000E-08, .76000000E+03, .80340000E-08,
     +   .78000000E+03, .67980000E-08, .80000000E+03, .57680000E-08,
     +   .82000000E+03, .45320000E-08, .84000000E+03, .36050000E-08,
     +   .86000000E+03, .28840000E-08, .88000000E+03, .22660000E-08,
     +   .90000000E+03, .18540000E-08, .92000000E+03, .15450000E-08,
     +   .94000000E+03, .14420000E-08, .96000000E+03, .14420000E-08,
     +   .98000000E+03, .13390000E-08, .10000000E+04, .12360000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10, .30000000E+04, .29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /

          real*4 psf756a(192), psf756b(190)
	  data psf756a/
     +   .00000000E+00, .59740000E+00,
     +   .10000000E+00, .58710000E+00, .20000000E+00, .54590000E+00,
     +   .30000000E+00, .49440000E+00, .40000000E+00, .43260000E+00,
     +   .50000000E+00, .37080000E+00, .60000000E+00, .30900000E+00,
     +   .70000000E+00, .23690000E+00, .80000010E+00, .17510000E+00,
     +   .90000010E+00, .13390000E+00, .10000000E+01, .92700000E-01,
     +   .11000000E+01, .61800000E-01, .12000000E+01, .39140000E-01,
     +   .13000000E+01, .23690000E-01, .14000000E+01, .15450000E-01,
     +   .15000000E+01, .97849990E-02, .16000000E+01, .47380000E-02,
     +   .17000000E+01, .19570000E-02, .18000000E+01, .80340000E-03,
     +   .19000000E+01, .51500000E-03, .20000000E+01, .39140000E-03,
     +   .25000000E+01, .17510000E-03, .30000000E+01, .12360000E-03,
     +   .35000000E+01, .92700000E-04, .40000000E+01, .72100000E-04,
     +   .45000000E+01, .70040000E-04, .50000000E+01, .50470000E-04,
     +   .55000000E+01, .42230000E-04, .60000000E+01, .38110000E-04,
     +   .65000000E+01, .33990000E-04, .70000000E+01, .29870000E-04,
     +   .75000000E+01, .27810000E-04, .80000000E+01, .25750000E-04,
     +   .85000000E+01, .22660000E-04, .90000000E+01, .20600000E-04,
     +   .95000000E+01, .19570000E-04, .10000000E+02, .17510000E-04,
     +   .10500000E+02, .16480000E-04, .11000000E+02, .15450000E-04,
     +   .11500000E+02, .14420000E-04, .12000000E+02, .13390000E-04,
     +   .12500000E+02, .12360000E-04, .13000000E+02, .12360000E-04,
     +   .13500000E+02, .11330000E-04, .14000000E+02, .10300000E-04,
     +   .14500000E+02, .10094000E-04, .15000000E+02, .94760000E-05,
     +   .15500000E+02, .89609990E-05, .16000000E+02, .84460000E-05,
     +   .16500000E+02, .80340000E-05, .17000000E+02, .77250000E-05,
     +   .17500000E+02, .73130000E-05, .18000000E+02, .69010000E-05,
     +   .18500000E+02, .65920000E-05, .19000000E+02, .62830000E-05,
     +   .19500000E+02, .59740000E-05, .20000000E+02, .56650000E-05,
     +   .21000000E+02, .51500000E-05, .22000000E+02, .47380000E-05,
     +   .23000000E+02, .44290000E-05, .24000000E+02, .41200000E-05,
     +   .25000000E+02, .38110000E-05, .26000000E+02, .36050000E-05,
     +   .27000000E+02, .33990000E-05, .28000000E+02, .31930000E-05,
     +   .29000000E+02, .30900000E-05, .30000000E+02, .28840000E-05,
     +   .31000000E+02, .27810000E-05, .32000000E+02, .26780000E-05,
     +   .33000000E+02, .25750000E-05, .34000000E+02, .24720000E-05,
     +   .35000000E+02, .23690000E-05, .36000000E+02, .22660000E-05,
     +   .37000000E+02, .21630000E-05, .38000000E+02, .20600000E-05,
     +   .39000000E+02, .20600000E-05, .40000000E+02, .19570000E-05,
     +   .50000000E+02, .12360000E-05, .60000000E+02, .87549990E-06,
     +   .70000000E+02, .63860000E-06, .80000000E+02, .51500000E-06,
     +   .90000000E+02, .41200000E-06, .10000000E+03, .33990000E-06,
     +   .11000000E+03, .28840000E-06, .12000000E+03, .25750000E-06,
     +   .13000000E+03, .22660000E-06, .14000000E+03, .20600000E-06,
     +   .15000000E+03, .18540000E-06, .16000000E+03, .16480000E-06,
     +   .17000000E+03, .15450000E-06, .18000000E+03, .14420000E-06,
     +   .19000000E+03, .13390000E-06, .20000000E+03, .12360000E-06,
     +   .22000000E+03, .10300000E-06, .24000000E+03, .84460000E-07,
     +   .26000000E+03,  .72100000E-07/

	  data psf756b /
     +   .28000000E+03, .61800000E-07,
     +   .30000000E+03, .53560000E-07, .32000000E+03, .47380000E-07,
     +   .34000000E+03, .43260000E-07, .36000000E+03, .38110000E-07,
     +   .38000000E+03, .33990000E-07, .40000000E+03, .30900000E-07,
     +   .42000000E+03, .26780000E-07, .44000000E+03, .24720000E-07,
     +   .46000000E+03, .21630000E-07, .48000000E+03, .20600000E-07,
     +   .50000000E+03, .18540000E-07, .52000000E+03, .17510000E-07,
     +   .54000000E+03, .16480000E-07, .56000000E+03, .15965000E-07,
     +   .58000000E+03, .15450000E-07, .60000000E+03, .15450000E-07,
     +   .62000000E+03, .14935000E-07, .64000000E+03, .14729000E-07,
     +   .66000000E+03, .14420000E-07, .68000000E+03, .13596000E-07,
     +   .70000000E+03, .12566000E-07, .72000000E+03, .11536000E-07,
     +   .74000000E+03, .99910000E-08, .76000000E+03, .80340000E-08,
     +   .78000000E+03, .67980000E-08, .80000000E+03, .57680000E-08,    
     +   .82000000E+03, .45320000E-08, .84000000E+03, .36050000E-08,
     +   .86000000E+03, .28840000E-08, .88000000E+03, .22660000E-08,
     +   .90000000E+03, .18540000E-08, .92000000E+03, .15450000E-08,
     +   .94000000E+03, .14420000E-08, .96000000E+03, .14420000E-08,
     +   .98000000E+03, .13390000E-08, .10000000E+04, .12360000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10, .30000000E+04, .29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /

      real*4 psf889a(192), psf889b(190)
          data psf889a/
     +   .00000000E+00, .31930000E+00,
     +   .10000000E+00, .29870000E+00, .20000000E+00, .28840000E+00,
     +   .30000000E+00, .27810000E+00, .40000000E+00, .25750000E+00,
     +   .50000000E+00, .23690000E+00, .60000000E+00, .21630000E+00,
     +   .70000000E+00, .19570000E+00, .80000010E+00, .16480000E+00,
     +   .90000010E+00, .14420000E+00, .10000000E+01, .11330000E+00,
     +   .11000000E+01, .95790000E-01, .12000000E+01, .78279990E-01,
     +   .13000000E+01, .61800000E-01, .14000000E+01, .47380000E-01,
     +   .15000000E+01, .36050000E-01, .16000000E+01, .25750000E-01,
     +   .17000000E+01, .18540000E-01, .18000000E+01, .12360000E-01,
     +   .19000000E+01, .80340000E-02, .20000000E+01, .66950000E-02,
     +   .25000000E+01, .16480000E-02, .30000000E+01, .50470000E-03,
     +   .35000000E+01, .30900000E-03, .40000000E+01, .22660000E-03,
     +   .45000000E+01, .18540000E-03, .50000000E+01, .15450000E-03,
     +   .55000000E+01, .13390000E-03, .60000000E+01, .11330000E-03,
     +   .65000000E+01, .94760000E-04, .70000000E+01, .82399990E-04,
     +   .75000000E+01, .69010000E-04, .80000000E+01, .59740000E-04,
     +   .85000000E+01, .51500000E-04, .90000000E+01, .45320000E-04,
     +   .95000000E+01, .39140000E-04, .10000000E+02, .35020000E-04,
     +   .10500000E+02, .32960000E-04, .11000000E+02, .29870000E-04,
     +   .11500000E+02, .26780000E-04, .12000000E+02, .24720000E-04,
     +   .12500000E+02, .23690000E-04, .13000000E+02, .21630000E-04,
     +   .13500000E+02, .20600000E-04, .14000000E+02, .19570000E-04,
     +   .14500000E+02, .17510000E-04, .15000000E+02, .16480000E-04,
     +   .15500000E+02, .14935000E-04, .16000000E+02, .13390000E-04,
     +   .16500000E+02, .12360000E-04, .17000000E+02, .11330000E-04,
     +   .17500000E+02, .11330000E-04, .18000000E+02, .10300000E-04,
     +   .18500000E+02, .96819990E-05, .19000000E+02, .90640000E-05,
     +   .19500000E+02, .85490000E-05, .20000000E+02, .81370000E-05,
     +   .21000000E+02, .72100000E-05, .22000000E+02, .63860000E-05,
     +   .23000000E+02, .57680000E-05, .24000000E+02, .52530000E-05,
     +   .25000000E+02, .47380000E-05, .26000000E+02, .44290000E-05,
     +   .27000000E+02, .41200000E-05, .28000000E+02, .37080000E-05,
     +   .29000000E+02, .35020000E-05, .30000000E+02, .32960000E-05,
     +   .31000000E+02, .31930000E-05, .32000000E+02, .29870000E-05,
     +   .33000000E+02, .28840000E-05, .34000000E+02, .27810000E-05,
     +   .35000000E+02, .26780000E-05, .36000000E+02, .25750000E-05,
     +   .37000000E+02, .24720000E-05, .38000000E+02, .23690000E-05,
     +   .39000000E+02, .22660000E-05, .40000000E+02, .21630000E-05,
     +   .50000000E+02, .14420000E-05, .60000000E+02, .90640000E-06,
     +   .70000000E+02, .59740000E-06, .80000000E+02, .41200000E-06,
     +   .90000000E+02, .31930000E-06, .10000000E+03, .25750000E-06,
     +   .11000000E+03, .22660000E-06, .12000000E+03, .19570000E-06,
     +   .13000000E+03, .17510000E-06, .14000000E+03, .16480000E-06,
     +   .15000000E+03, .15450000E-06, .16000000E+03, .14420000E-06,
     +   .17000000E+03, .13390000E-06, .18000000E+03, .12360000E-06,
     +   .19000000E+03, .12360000E-06, .20000000E+03, .11330000E-06,
     +   .22000000E+03, .10300000E-06, .24000000E+03, .92700000E-07,
     +   .26000000E+03,  .82400000E-07/ 

	 data psf889b/
     +   .28000000E+03, .73130000E-07,
     +   .30000000E+03, .64890000E-07, .32000000E+03, .59740000E-07,
     +   .34000000E+03, .52530000E-07, .36000000E+03, .47380000E-07,
     +   .38000000E+03, .43260000E-07, .40000000E+03, .39140000E-07,
     +   .42000000E+03, .36050000E-07, .44000000E+03, .33990000E-07,
     +   .46000000E+03, .31930000E-07, .48000000E+03, .28840000E-07,
     +   .50000000E+03, .27810000E-07, .52000000E+03, .26780000E-07,
     +   .54000000E+03, .25750000E-07, .56000000E+03, .25750000E-07,
     +   .58000000E+03, .24720000E-07, .60000000E+03, .24720000E-07,
     +   .62000000E+03, .24720000E-07, .64000000E+03, .24720000E-07,
     +   .66000000E+03, .24720000E-07, .68000000E+03, .23690000E-07,
     +   .70000000E+03, .23690000E-07, .72000000E+03, .22660000E-07,
     +   .74000000E+03, .21630000E-07, .76000000E+03, .20600000E-07,
     +   .78000000E+03, .20600000E-07, .80000000E+03, .19570000E-07,
     +   .82000000E+03, .18540000E-07, .84000000E+03, .16480000E-07,
     +   .86000000E+03, .14420000E-07, .88000000E+03, .11330000E-07,
     +   .90000000E+03, .80340000E-08, .92000000E+03, .46350000E-08,
     +   .94000000E+03, .42230000E-08, .96000000E+03, .39140000E-08,
     +   .98000000E+03, .36050000E-08, .10000000E+04, .32960000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10, .30000000E+04, .29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /


          real*4 psf968a(192), psf968b(190)
          data psf968a/
     +   .00000000E+00, .40170000E+00,
     +   .10000000E+00, .38625000E+00, .20000000E+00, .37080000E+00,
     +   .30000000E+00, .32960000E+00, .40000000E+00, .30900000E+00,
     +   .50000000E+00, .28840000E+00, .60000000E+00, .24720000E+00,
     +   .70000000E+00, .22660000E+00, .80000010E+00, .19570000E+00,
     +   .90000010E+00, .14420000E+00, .10000000E+01, .11845000E+00,
     +   .11000000E+01, .99910000E-01, .12000000E+01, .77250000E-01,
     +   .13000000E+01, .61800000E-01, .14000000E+01, .41200000E-01,
     +   .15000000E+01, .26780000E-01, .16000000E+01, .14420000E-01,
     +   .17000000E+01, .11330000E-01, .18000000E+01, .72100000E-02,
     +   .19000000E+01, .44290000E-02, .20000000E+01, .31930000E-02,
     +   .25000000E+01, .87550000E-03, .30000000E+01, .66950000E-03,
     +   .35000000E+01, .51500000E-03, .40000000E+01, .41200000E-03,
     +   .45000000E+01, .33990000E-03, .50000000E+01, .28840000E-03,
     +   .55000000E+01, .23690000E-03, .60000000E+01, .20600000E-03,
     +   .65000000E+01, .17510000E-03, .70000000E+01, .15450000E-03,
     +   .75000000E+01, .13390000E-03, .80000000E+01, .12360000E-03,
     +   .85000000E+01, .10815000E-03, .90000000E+01, .95790000E-04,
     +   .95000000E+01, .86520000E-04, .10000000E+02, .78280000E-04,
     +   .10500000E+02, .72100000E-04, .11000000E+02, .65920000E-04,
     +   .11500000E+02, .59740000E-04, .12000000E+02, .54590000E-04,
     +   .12500000E+02, .49440000E-04, .13000000E+02, .45320000E-04,
     +   .13500000E+02, .43260000E-04, .14000000E+02, .39140000E-04,
     +   .14500000E+02, .37080000E-04, .15000000E+02, .33990000E-04,
     +   .15500000E+02, .31930000E-04, .16000000E+02, .29870000E-04,
     +   .16500000E+02, .27810000E-04, .17000000E+02, .25750000E-04,
     +   .17500000E+02, .24720000E-04, .18000000E+02, .22660000E-04,
     +   .18500000E+02, .21630000E-04, .19000000E+02, .20600000E-04,
     +   .19500000E+02, .19570000E-04, .20000000E+02, .18540000E-04,
     +   .21000000E+02, .16480000E-04, .22000000E+02, .14420000E-04,
     +   .23000000E+02, .13390000E-04, .24000000E+02, .11330000E-04,
     +   .25000000E+02, .10300000E-04, .26000000E+02, .92700000E-05,
     +   .27000000E+02, .82400000E-05, .28000000E+02, .75190000E-05,
     +   .29000000E+02, .66950000E-05, .30000000E+02, .60770000E-05,
     +   .31000000E+02, .54590000E-05, .32000000E+02, .49440000E-05,
     +   .33000000E+02, .46350000E-05, .34000000E+02, .42230000E-05,
     +   .35000000E+02, .38110000E-05, .36000000E+02, .35020000E-05,
     +   .37000000E+02, .32960000E-05, .38000000E+02, .30900000E-05,
     +   .39000000E+02, .28840000E-05, .40000000E+02, .26780000E-05,
     +   .50000000E+02, .14420000E-05, .60000000E+02, .13390000E-05,
     +   .70000000E+02, .11330000E-05, .80000000E+02, .90640000E-06,
     +   .90000000E+02, .72100000E-06, .10000000E+03, .59740000E-06,
     +   .11000000E+03, .51500000E-06, .12000000E+03, .43260000E-06,
     +   .13000000E+03, .37080000E-06, .14000000E+03, .36050000E-06,
     +   .15000000E+03, .28840000E-06, .16000000E+03, .26780000E-06,
     +   .17000000E+03, .23690000E-06, .18000000E+03, .21630000E-06,
     +   .19000000E+03, .19570000E-06, .20000000E+03, .17510000E-06,
     +   .22000000E+03, .14420000E-06, .24000000E+03, .10300000E-06,
     +   .26000000E+03,  .81370000E-07/

	  data psf968b/
     +   .28000000E+03, .63860000E-07,
     +   .30000000E+03, .53560000E-07, .32000000E+03, .47380000E-07,
     +   .34000000E+03, .43260000E-07, .36000000E+03, .39140000E-07,
     +   .38000000E+03, .36050000E-07, .40000000E+03, .33990000E-07,
     +   .42000000E+03, .31930000E-07, .44000000E+03, .28840000E-07,
     +   .46000000E+03, .26780000E-07, .48000000E+03, .25750000E-07,
     +   .50000000E+03, .23690000E-07, .52000000E+03, .22660000E-07,
     +   .54000000E+03, .21630000E-07, .56000000E+03, .20600000E-07,
     +   .58000000E+03, .19570000E-07, .60000000E+03, .19055000E-07,
     +   .62000000E+03, .18025000E-07, .64000000E+03, .17510000E-07,
     +   .66000000E+03, .16995000E-07, .68000000E+03, .16480000E-07,
     +   .70000000E+03, .16995000E-07, .72000000E+03, .17510000E-07,
     +   .74000000E+03, .17716000E-07, .76000000E+03, .18025000E-07,
     +   .78000000E+03, .18025000E-07, .80000000E+03, .18025000E-07,
     +   .82000000E+03, .17510000E-07, .84000000E+03, .16480000E-07,
     +   .86000000E+03, .15450000E-07, .88000000E+03, .14420000E-07,
     +   .90000000E+03, .15450000E-07, .92000000E+03, .10300000E-07,
     +   .94000000E+03, .92082000E-08, .96000000E+03, .82605990E-08,
     +   .98000000E+03, .74160000E-08, .10000000E+04, .66950000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10, .30000000E+04, .29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /

          real*4 psf727a(192), psf727b(190)
          data psf727a/
     +   .00000000E+00, .60770000E+00,
     +   .10000000E+00, .59740000E+00, .20000000E+00, .56650000E+00,
     +   .30000000E+00, .51500000E+00, .40000000E+00, .46350000E+00,
     +   .50000000E+00, .38110000E+00, .60000000E+00, .30900000E+00,
     +   .70000000E+00, .25750000E+00, .80000010E+00, .20600000E+00,
     +   .90000010E+00, .15450000E+00, .10000000E+01, .92700000E-01,
     +   .11000000E+01, .65920000E-01, .12000000E+01, .43260000E-01,
     +   .13000000E+01, .37080000E-01, .14000000E+01, .26780000E-01,
     +   .15000000E+01, .88580000E-02, .16000000E+01, .30900000E-02,
     +   .17000000E+01, .12360000E-02, .18000000E+01, .59740000E-03,
     +   .19000000E+01, .41200000E-03, .20000000E+01, .32960000E-03,
     +   .25000000E+01, .25750000E-03, .30000000E+01, .25750000E-03,
     +   .35000000E+01, .19570000E-03, .40000000E+01, .16480000E-03,
     +   .45000000E+01, .14420000E-03, .50000000E+01, .13390000E-03,
     +   .55000000E+01, .11330000E-03, .60000000E+01, .10300000E-03,
     +   .65000000E+01, .94760000E-04, .70000000E+01, .87550000E-04,
     +   .75000000E+01, .79310000E-04, .80000000E+01, .72100000E-04,
     +   .85000000E+01, .65920000E-04, .90000000E+01, .59740000E-04,
     +   .95000000E+01, .55620000E-04, .10000000E+02, .51500000E-04,
     +   .10500000E+02, .46350000E-04, .11000000E+02, .43260000E-04,
     +   .11500000E+02, .39140000E-04, .12000000E+02, .36050000E-04,
     +   .12500000E+02, .32960000E-04, .13000000E+02, .30900000E-04,
     +   .13500000E+02, .28840000E-04, .14000000E+02, .26780000E-04,
     +   .14500000E+02, .25750000E-04, .15000000E+02, .23690000E-04,
     +   .15500000E+02, .22660000E-04, .16000000E+02, .20600000E-04,
     +   .16500000E+02, .19570000E-04, .17000000E+02, .18540000E-04,
     +   .17500000E+02, .17510000E-04, .18000000E+02, .16480000E-04,
     +   .18500000E+02, .15450000E-04, .19000000E+02, .15450000E-04,
     +   .19500000E+02, .14420000E-04, .20000000E+02, .13390000E-04,
     +   .21000000E+02, .12360000E-04, .22000000E+02, .12360000E-04,
     +   .23000000E+02, .11330000E-04, .24000000E+02, .10300000E-04,
     +   .25000000E+02, .95790000E-05, .26000000E+02, .89609990E-05,
     +   .27000000E+02, .85490000E-05, .28000000E+02, .81370000E-05,
     +   .29000000E+02, .77250000E-05, .30000000E+02, .74160000E-05,
     +   .31000000E+02, .70040000E-05, .32000000E+02, .66950000E-05,
     +   .33000000E+02, .63860000E-05, .34000000E+02, .61800000E-05,
     +   .35000000E+02, .59740000E-05, .36000000E+02, .56650000E-05,
     +   .37000000E+02, .53560000E-05, .38000000E+02, .51500000E-05,
     +   .39000000E+02, .49440000E-05, .40000000E+02, .47380000E-05,
     +   .50000000E+02, .26780000E-05, .60000000E+02, .16480000E-05,
     +   .70000000E+02, .11330000E-05, .80000000E+02, .78280000E-06,
     +   .90000000E+02, .59740000E-06, .10000000E+03, .49440000E-06,
     +   .11000000E+03, .43260000E-06, .12000000E+03, .39140000E-06,
     +   .13000000E+03, .33990000E-06, .14000000E+03, .30900000E-06,
     +   .15000000E+03, .28840000E-06, .16000000E+03, .26780000E-06,
     +   .17000000E+03, .24720000E-06, .18000000E+03, .22660000E-06,
     +   .19000000E+03, .21630000E-06, .20000000E+03, .19570000E-06,
     +   .22000000E+03,.16480000E-06, .24000000E+03, .14420000E-06, 
     +   .26000000E+03,  .11330000E-06/
 
         data psf727b/
     +   .28000000E+03, .10094000E-06,
     +   .30000000E+03, .85490000E-07, .32000000E+03, .74160000E-07,
     +   .34000000E+03, .64890000E-07, .36000000E+03, .57680000E-07,
     +   .38000000E+03, .52530000E-07, .40000000E+03, .48410000E-07,
     +   .42000000E+03, .44290000E-07, .44000000E+03, .42230000E-07,
     +   .46000000E+03, .39140000E-07, .48000000E+03, .37080000E-07,
     +   .50000000E+03, .35020000E-07, .52000000E+03, .33990000E-07,
     +   .54000000E+03, .32960000E-07, .56000000E+03, .31930000E-07,
     +   .58000000E+03, .30900000E-07, .60000000E+03, .29870000E-07,
     +   .62000000E+03, .28840000E-07, .64000000E+03, .28840000E-07,
     +   .66000000E+03, .27810000E-07, .68000000E+03, .26780000E-07,
     +   .70000000E+03, .24720000E-07, .72000000E+03, .21630000E-07,
     +   .74000000E+03, .18540000E-07, .76000000E+03, .14420000E-07,
     +   .78000000E+03, .11330000E-07, .80000000E+03, .84459990E-08,
     +   .82000000E+03, .57680000E-08, .84000000E+03, .41200000E-08,
     +   .86000000E+03, .28840000E-08, .88000000E+03, .22660000E-08,
     +   .90000000E+03, .18540000E-08, .92000000E+03, .15450000E-08,
     +   .94000000E+03, .14420000E-08, .96000000E+03, .14420000E-08,
     +   .98000000E+03, .13390000E-08, .10000000E+04, .12360000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10,  .30000000E+04,.29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /

          real*4 psfvlta(192), psfvltb(190)
          data psfvlta/
     +   .00000000E+00, .10300000E+01,
     +   .10000000E+00, .98880000E+00, .20000000E+00, .92699990E+00,
     +   .30000000E+00, .80340000E+00, .40000000E+00, .63860000E+00,
     +   .50000000E+00, .46350000E+00, .60000000E+00, .27810000E+00,
     +   .70000000E+00, .17510000E+00, .80000010E+00, .11330000E+00,
     +   .90000010E+00, .67980000E-01, .10000000E+01, .44290000E-01,
     +   .11000000E+01, .27810000E-01, .12000000E+01, .13390000E-01,
     +   .13000000E+01, .50470000E-02, .14000000E+01, .18540000E-02,
     +   .15000000E+01, .87550000E-03, .16000000E+01, .30900000E-03,
     +   .17000000E+01, .13390000E-03, .18000000E+01, .10300000E-03,
     +   .19000000E+01, .84460000E-04, .20000000E+01, .72100000E-04,
     +   .25000000E+01, .61800000E-04, .30000000E+01, .51500000E-04,
     +   .35000000E+01, .45320000E-04, .40000000E+01, .40170000E-04,
     +   .45000000E+01, .35020000E-04, .50000000E+01, .30900000E-04,
     +   .55000000E+01, .28840000E-04, .60000000E+01, .25750000E-04,
     +   .65000000E+01, .23690000E-04, .70000000E+01, .21630000E-04,
     +   .75000000E+01, .20600000E-04, .80000000E+01, .18540000E-04,
     +   .85000000E+01, .17510000E-04, .90000000E+01, .15450000E-04,
     +   .95000000E+01, .14420000E-04, .10000000E+02, .13390000E-04,
     +   .10500000E+02, .13390000E-04, .11000000E+02, .12360000E-04,
     +   .11500000E+02, .11330000E-04, .12000000E+02, .10300000E-04,
     +   .12500000E+02, .98880000E-05, .13000000E+02, .92700000E-05,
     +   .13500000E+02, .87550000E-05, .14000000E+02, .82400000E-05,
     +   .14500000E+02, .77250000E-05, .15000000E+02, .72100000E-05,
     +   .15500000E+02, .70040000E-05, .16000000E+02, .64890000E-05,
     +   .16500000E+02, .61800000E-05, .17000000E+02, .59740000E-05,
     +   .17500000E+02, .56650000E-05, .18000000E+02, .53560000E-05,
     +   .18500000E+02, .51500000E-05, .19000000E+02, .49440000E-05,
     +   .19500000E+02, .47380000E-05, .20000000E+02, .45320000E-05,
     +   .21000000E+02, .42230000E-05, .22000000E+02, .39140000E-05,
     +   .23000000E+02, .37080000E-05, .24000000E+02, .33990000E-05,
     +   .25000000E+02, .31930000E-05, .26000000E+02, .30900000E-05,
     +   .27000000E+02, .28840000E-05, .28000000E+02, .27810000E-05,
     +   .29000000E+02, .26780000E-05, .30000000E+02, .24720000E-05,
     +   .31000000E+02, .23690000E-05, .32000000E+02, .22660000E-05,
     +   .33000000E+02, .21630000E-05, .34000000E+02, .20600000E-05,
     +   .35000000E+02, .19570000E-05, .36000000E+02, .18540000E-05,
     +   .37000000E+02, .18540000E-05, .38000000E+02, .17510000E-05,
     +   .39000000E+02, .17510000E-05, .40000000E+02, .16480000E-05,
     +   .50000000E+02, .11330000E-05, .60000000E+02, .74160000E-06,
     +   .70000000E+02, .51500000E-06, .80000000E+02, .38110000E-06,
     +   .90000000E+02, .29870000E-06, .10000000E+03, .24720000E-06,
     +   .11000000E+03, .20600000E-06, .12000000E+03, .18540000E-06,
     +   .13000000E+03, .16480000E-06, .14000000E+03, .15450000E-06,
     +   .15000000E+03, .14420000E-06, .16000000E+03, .13390000E-06,
     +   .17000000E+03, .13390000E-06, .18000000E+03, .13390000E-06,
     +   .19000000E+03, .12360000E-06, .20000000E+03, .11330000E-06,
     +   .22000000E+03, .10300000E-06, .24000000E+03, .92700000E-07,
     +   .26000000E+03, .83430000E-07 /

	  data psfvltb/
     +   .28000000E+03, .77250000E-07,
     +   .30000000E+03, .70040000E-07, .32000000E+03, .64890000E-07,
     +   .34000000E+03, .59740000E-07, .36000000E+03, .55620000E-07,
     +   .38000000E+03, .51500000E-07, .40000000E+03, .46350000E-07,
     +   .42000000E+03, .43260000E-07, .44000000E+03, .39140000E-07,
     +   .46000000E+03, .35020000E-07, .48000000E+03, .31930000E-07,
     +   .50000000E+03, .28840000E-07, .52000000E+03, .26780000E-07,
     +   .54000000E+03, .23690000E-07, .56000000E+03, .21630000E-07,
     +   .58000000E+03, .20600000E-07, .60000000E+03, .18540000E-07,
     +   .62000000E+03, .17510000E-07, .64000000E+03, .16480000E-07,
     +   .66000000E+03, .15450000E-07, .68000000E+03, .13905000E-07,
     +   .70000000E+03, .12875000E-07, .72000000E+03, .11845000E-07,
     +   .74000000E+03, .10300000E-07, .76000000E+03, .96820000E-08,
     +   .78000000E+03, .87549990E-08, .80000000E+03, .82400000E-08,
     +   .82000000E+03, .70040000E-08, .84000000E+03, .61800000E-08,
     +   .86000000E+03, .53560000E-08, .88000000E+03, .45320000E-08,
     +   .90000000E+03, .38110000E-08, .92000000E+03, .30900000E-08,
     +   .94000000E+03, .28840000E-08, .96000000E+03, .26780000E-08,
     +   .98000000E+03, .24720000E-08, .10000000E+04, .22660000E-08,
     +   .15000000E+04, .66950000E-09, .20000000E+04, .16480000E-09,
     +   .25000000E+04, .37080000E-10, .30000000E+04, .29870000E-10,
     +   .35000000E+04, .28840000E-10, .40000000E+04, .21630000E-10,
     +   .45000000E+04, .14420000E-10, .50000000E+04, .84460000E-11,
     +   .55000000E+04, .67980000E-11, .60000000E+04, .61800000E-11,
     +   .65000000E+04, .47380000E-11, .70000000E+04, .38110000E-11,
     +   .75000000E+04, .32960000E-11, .80000000E+04, .30900000E-11,
     +   .85000000E+04, .29870000E-11, .90000000E+04, .23690000E-11,
     +   .95000000E+04, .18540000E-11, .10000000E+05, .17510000E-11,
     +   .10500000E+05, .14420000E-11, .11000000E+05, .11330000E-11,
     +   .11500000E+05, .92699990E-12, .12000000E+05, .82400000E-12,
     +   .12500000E+05, .74160000E-12, .13000000E+05, .74160000E-12,
     +   .13500000E+05, .12360000E-11, .14000000E+05, .14420000E-11,
     +   .14500000E+05, .12360000E-11, .15000000E+05, .10815000E-11,
     +   .15500000E+05, .85490000E-12, .16000000E+05, .72100000E-12,
     +   .16500000E+05, .58710000E-12, .17000000E+05, .49440000E-12,
     +   .17500000E+05, .46350000E-12, .18000000E+05, .45320000E-12,
     +   .18500000E+05, .43260000E-12, .19000000E+05, .42230000E-12,
     +   .19500000E+05, .41200000E-12, .20000000E+05, .40170000E-12,
     +   .20500000E+05, .39140000E-12, .21000000E+05, .38110000E-12,
     +   .21500000E+05, .37080000E-12, .22000000E+05, .37080000E-12,
     +   .22500000E+05, .37080000E-12, .23000000E+05, .36565000E-12,
     +   .23500000E+05, .36050000E-12, .24000000E+05, .36050000E-12,
     +   .24500000E+05, .36050000E-12, .25000000E+05, .35535000E-12,
     +   .25500000E+05, .35020000E-12, .26000000E+05, .34505000E-12,
     +   .26500000E+05, .33990000E-12, .27000000E+05, .32960000E-12,
     +   .27500000E+05, .32754000E-12, .28000000E+05, .31930000E-12,
     +   .28500000E+05, .30900000E-12, .29000000E+05, .30385000E-12,
     +   .29500000E+05, .29870000E-12, .30000000E+05, .29355000E-12 /


      call xvmessage('GLLPSF version 8-MAR-96',' ')
      call xveaction('SA',' ')

      call xvparm('NL',nl,count,def,1)               
      call xvparm('NS',ns,count,def,1)               
      call xvparm('FILT',filt,count,def,1)
      if (filt.eq.'CLR' .or. filt .eq. 'CLEAR') then
	 npsf = 129
      else
	 npsf = 191
      endif	
      call xvparm('PSF',buf,count,def,4096)               
      if (count.gt.0) then  !copy into psf, reversing order
         npsf=count/2
         j=0
         do i=1,npsf
            j=j+1
            psf(2,i)=buf(j)         
            j=j+1
            psf(1,i)=buf(j)
         enddo
      else
         index = 1                    ! Added code to handle GLL filters-OAM
         msg(1:27) = 'processing filter:         '

		if (filt.eq.'GRN' .or. filt .eq. 'GREEN') then   
			call one_to_2_dimen(psfgrna,psf,index,1,192)
			call one_to_2_dimen(psfgrnb,psf,index,1,190)
                        msg(21:27)= filt(1:7) !verifying filter   
		elseif (filt.eq.'RED' ) then       
                        call one_to_2_dimen(psfreda,psf,index,1,192)
                        call one_to_2_dimen(psfredb,psf,index,1,190)
                        msg(21:27)= filt(1:7)    
		elseif (filt.eq.'968' .or. filt .eq. 'IR-9680') then
                        call one_to_2_dimen(psf968a,psf,index,1,192)
                        call one_to_2_dimen(psf968b,psf,index,1,190)
                        msg(21:27)= filt(1:7)    
  		elseif (filt.eq.'756' .or. filt .eq. 'IR-7560') then
		   	call one_to_2_dimen(psf756a,psf,index,1,192)
                        call one_to_2_dimen(psf756b,psf,index,1,190)
                        msg(21:27)= filt(1:7)    
                elseif (filt.eq.'727' .or. filt .eq. 'IR-7270') then
		        call one_to_2_dimen(psf727a,psf,index,1,192)
                        call one_to_2_dimen(psf727b,psf,index,1,190)
                        msg(21:27)= filt(1:7)    
                elseif (filt.eq.'889' .or. filt .eq. 'IR-8890') then
			call one_to_2_dimen(psf889a,psf,index,1,192)
                        call one_to_2_dimen(psf889b,psf,index,1,190)
                        msg(21:27)= filt(1:7)    
		elseif (filt.eq.'VLT' .or. filt .eq. 'VIOLET') then
			call one_to_2_dimen(psfvlta,psf,index,1,192)
                        call one_to_2_dimen(psfvltb,psf,index,1,190)
                        msg(21:27)= filt(1:7)   
                else    
                        msg(21:27)= 'CLEAR '
		endif
       call  xvmessage(msg(1:27),' ')       
       endif				


c open output
      call xvunit(ounit,'OUT',1,status,' ')
      call xvopen(ounit,status,'O_FORMAT','REAL','U_FORMAT','REAL',
     +            'U_NL',nl,'U_NS',ns,'OP','WRITE',' ')

      nl2=(nl/2)+1
      ns2=(ns/2)+1
      if(psf(1,npsf).lt.ns2.or.psf(1,npsf).lt.nl2)then
         call xvmessage('WARNING: The PSF does not extend',' ')
         call xvmessage('to edge of image',' ')
         call xvmessage('Will extrapolate last 2 points',' ')
      endif

      weight=0.0
c write output loop
      do l=1,nl                       ! line loop

        do i=1,ns                     ! sample loop

c         determine which quadrant point is in and then compute d
c         the distance from the origin in pixels.
c         ............
c         .     .    .
c         .  1  . 2  .
c         ............
c         .     .    .
c         .  3  . 4  .
c         ............

          if(l.gt.nl2)then        ! quadrants 3 or 4
             if(i.gt.ns2)then     ! quadrant 4
                d=sqrt(real((nl+1-l)**2+(ns+1-i)**2))
             else                 ! quadrant 3
                d=sqrt(real((nl+1-l)**2+(i-1)**2))
             endif
          else 
             if(i.gt.ns2)then   ! quadrant 2            
                d=sqrt(real((l-1)**2+(ns+1-i)**2))
             else                 ! quadrant 1
                d=sqrt(real((l-1)**2+(i-1)**2))
             endif
          endif

c         compute index j of psf table such that psf(1,j) is just below d.
          do j=1,npsf-1
             if(psf(1,j+1).gt.d) go to 10
          enddo
          j=npsf-1
10        continue

c         compute amplitude of psf at d
          buf(i)=(psf(2,j)*(psf(1,j+1)-d) +
     +            psf(2,j+1)*(d-psf(1,j))) /
     +            (psf(1,j+1)-psf(1,j))
          weight=weight+buf(i)

        enddo                         ! end sample loop

        call xvwrit(ounit,buf,status,' ')
      enddo                           ! end line loop

      call xvclose(ounit,status,' ')

      ! The following lines were changed because garbage was
      !  printed after the write statement in linux -jaw
      !msg(1:48) = 'Normalizing by total weight sum of =****.*****  ' 
      !write (msg(37:46),'(F10.5)') weight

      write (msg,9901) weight
 9901 format('Normalizing by total weight sum of =',F10.5)
      call xvmessage(msg,' ')

c open output for update
      call xvunit(ounit,'OUT',1,status,' ')
      call xvopen(ounit,status,'O_FORMAT','REAL',
     +              'U_FORMAT','REAL','OP','UPDATE',' ')

c rescale output so the sum of the weights equals one.
c this assures that the otf has amplitude 1 at dc.
      do l=1,nl
        call xvread(ounit,buf,status,'LINE',l,' ')
        do i=1,ns
          buf(i)=buf(i)/weight
        enddo
        call xvwrit(ounit,buf,status,'LINE',l,' ')
      enddo
      call xvclose(ounit,status,' ')


      return
      end

c
c   subroutine to fill psf buffer with correct filter values.
c
	subroutine one_to_2_dimen(A,R,NI,From,To) 
	real*4 A(192),R(2,191)
	integer From,To,Step
	step = 2
	do I = From,To - 1 , Step
		      R(1,NI) = A(I)
		      R(2,NI) = A(I+1)
		      NI= NI + 1
	enddo
	end
      













$ VOKAGLEVE
$ Return
$!#############################################################################
$Imake_File:
$ create gllpsf.imake
/***********************************************************************

                     IMAKE FILE FOR PROGRAM gllpsf

   To Create the build file give the command:

		$ vimake gllpsf			(VMS)
   or
		% vimake gllpsf			(Unix)


************************************************************************/


#define PROGRAM	gllpsf
/*#define GLLLIB*/

#define MODULE_LIST gllpsf.f

#define MAIN_LANG_FORTRAN
#define USES_FORTRAN

#define LIB_RTL
#define LIB_TAE
#define LIB_P2SUB
/************************* End of Imake file ***************************/
$ Return
$!#############################################################################
$PDF_File:
$ create gllpsf.pdf
process help=*

parm NL    type=integer count=1 default=512
parm NS    type=integer count=1 default=512
parm OUT   count = 1
parm FILT  type=(string,7) default=CLEAR valid=(CLR,CLEAR,RED,VLT,VIOLET,IR-8890,889,GREEN,GRN,IR-9680,968,IR-7270,727,IR-7560,756)

parm PSF   type = real count = 0:258 default = --
end-proc
!special comments:
!# annot function = (mathematical/fourier,projects/galileo/corrections)
!# annot project = galileo
!# annot keyboard = ("scattered light correction",fourier,"point spread function",fft)

.title
VICAR2 program GLLPSF

.help
PURPOSE
GLLPSF generates a two dimensional point spread function in fft format
suitable to be converted into a two dimensional optical transfer function
by vicar program fft22. The output of fft22 can be input to vicar program
wiener as the second input file.

EXECUTION
    gllpsf out=a.img nl=1024 ns=1024

OUTPUT FILES:
The output is a real image nl by ns in fft suitable format, ie: with the
origin of the psf at the upper left.

EXAMPLE
  gllpsf out=psf nl=512 ns=512 psf=(1.,0.,0.,10.)
  fft22  inp=psf out=otf 
  fft22  inp=pix out=fftpix nl=512 ns=512
  wiener inp=(fftpix,otf) out=fixfftpix sn=45.
  fft22 inp=fixfftpix out=newpix mode=inverse format=half
 
WRITTEN BY: 		J Lorre 1/20/92


!

.level1

.vari NL
output number
of lines

.vari NS
output number
of samples

.vari OUT
output image files

.vari FILT
image filter
RED,GRN,VLT,CLR,889
  968,727,756

.vari PSF
point spread
function profile

.level2
.vari NL
output number of lines.
defaults to 512

.vari NS
output number of samples
defaults to 512

.vari OUT
output image file in real format of dimensions nl and ns.

.vari FILT
GLLPSF includes point spread function values specific to Galileo
filters.  If filt = GRN, the values specific to the green filter
will be created, etc.  If the user enters values in PSF parameter,
this FILT parameter is ignored.

.vari PSF
point spread function profile as pairs of values beginning at the center of
the psf and extending to the tail of the psf.  The first value of each
pair is the psf amplitude. The last (second) value of each pair is the
distance from the origin in pixels. Make sure that the last pair has a
distance large enough to encompass the image.
Example:  psf=(1.,0.,.8,1.,.3,2.,0.1,10,0.,60.)
Default is to use the built in GLL psf profile.
.end

$ Return
$!#############################################################################
$Test_File:
$ create tstgllpsf.pdf
procedure
refgbl $echo
refgbl $syschar
body
local PATH  TYPE=STRING init="wms_test_work:[testdata.gll]"
let _onfail="continue"
let $echo="yes"

!!	These test cases correspond to the CLR 
!!	filter.
!!
!!
gllpsf out=psf.img nl=8 ns=8
list psf.img
gllpsf out=psf.img nl=8 ns=8 psf=(1.,0.,2.,2.,0.,10.)
list psf.img
!!
gllpsf out=psf.img nl=16 ns=16
fft22  inp=psf.img out=otf.img 
list psf.img
list otf.img
!
!!
!!	These test cases test other 
!!	filters.
!!
if ($syschar(1)="UNIX")
  let PATH="/project/test_work/testdata/gll/"
end-if

# COMMENT OUT THIS SECTION UNTIL GLLFILLIN IS RESTORED (OR 600.FILL FOUND):
#gllfillin "&PATH"s0202556000.sos 6000.fill 'YES max=2
#adespike 6000.fill 6000.spk tol=600

adespike "&PATH"s0202556100.sos 6100.spk tol=600
adespike "&PATH"s0202556200.sos xa tol=400
adespike xa 6200.spk tol=400
adespike "&PATH"s0202556245.sos  6245.spk tol=400
!!
!!  Add in scattered light correction - Needed to cut out an area the size
!!   of the power of 2 (128 x 128 in this case) because the missing lines
!!   threw off the correction in the dark sky area.
!!
#copy 6000.spk 6000.soscut (280,320,128,256)
gllpsf out=psf nl=128 ns=256 filt=GRN
list psf sinc=26 linc=10
#fft22  inp=psf out=otf
#fft22  inp=6000.soscut out=fftpix nl=128 ns=256
#wiener inp=(fftpix,otf) out=fixfftpix sn=45.
#fft22 inp=fixfftpix out=6000.scat mode=inverse format=half

copy 6100.spk 6100.soscut (280,320,128,256)
gllpsf filt=VLT out=psf nl=128 ns=256
list psf sinc=26 linc=10
fft22  inp=psf out=otf
fft22  inp=6100.soscut out=fftpix nl=128 ns=256
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
fft22 inp=fixfftpix out=6100.scat mode=inverse format=half


copy 6200.spk 6200.soscut (280,320,128,256)
gllpsf filt=968 out=psf nl=128 ns=256
list psf sinc=26 linc=10
fft22  inp=psf out=otf
fft22  inp=6200.soscut out=fftpix nl=128 ns=256
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
fft22  inp=fixfftpix out=6200.scat mode=inverse format=half


copy "&PATH"s0202556245.sos 6245.soscut (280,320,128,256)
gllpsf filt=889 out=psf nl=128 ns=256
list psf sinc=26 linc=10
fft22  inp=psf out=otf
fft22  inp=6245.soscut out=fftpix nl=128 ns=256
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
fft22  inp=fixfftpix out=6245.scat mode=inverse format=half

if ($syschar(1)="UNIX")
  ush rm psf.img            !delete created *.img files.
  ush rm otf.img 
  ush rm *soscut     
  ush rm psf  
  ush rm fftpix 
  ush rm otf      
  ush rm fixfftpix
  ush rm *spk
# ush rm *fill
else 
  dcl del psf.img;*            !delete created *.img files.
  dcl del otf.img;* 
  dcl del *.soscut;*     
  dcl del psf.*;*  
  dcl del fftpix.*;* 
  dcl del otf.*;*      
  dcl del fixfftpix.*;*
  dcl del *.spk;*
# dcl del *.fill;*
end-if
  write "The tester should diplay the input and the output from "
  write "the Ida test as shown below."
  write "use xwb0"
  write "vids"
# write "jdisp /project/test_work/testdata/gll/s0202556000.sos"
# write "jdisp 6000.scat"	
  write "jdisp /project/test_work/testdata/gll/s0202556100.sos"
  write "jdisp 6100.scat"
  write "jdisp /project/test_work/testdata/gll/s0202556200.sos"
  write "jdisp 6200.scat"
  write "jdisp /project/test_work/testdata/gll/s0202556245.sos"
  write "jdisp 6245.scat"			
let $echo="no"
end-proc






$!-----------------------------------------------------------------------------
$ create tstgllpsf.log_solos
tstgllpsf
gllpsf out=psf.img nl=8 ns=8
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  CLEAR
Normalizing by total weight sum of =   0.99540
list psf.img
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:11 2011
     Samp             1           2           3           4           5           6           7           8
   Line
      1       5.124E-01   9.845E-02   6.450E-04   3.416E-04   2.210E-04   3.416E-04   6.450E-04   9.845E-02
      2       9.845E-02   1.895E-02   5.492E-04   3.187E-04   2.111E-04   3.187E-04   5.492E-04   1.895E-02
      3       6.450E-04   5.492E-04   3.760E-04   2.606E-04   1.831E-04   2.606E-04   3.760E-04   5.492E-04
      4       3.416E-04   3.187E-04   2.606E-04   2.015E-04   1.507E-04   2.015E-04   2.606E-04   3.187E-04
      5       2.210E-04   2.111E-04   1.831E-04   1.507E-04   1.243E-04   1.507E-04   1.831E-04   2.111E-04
      6       3.416E-04   3.187E-04   2.606E-04   2.015E-04   1.507E-04   2.015E-04   2.606E-04   3.187E-04
      7       6.450E-04   5.492E-04   3.760E-04   2.606E-04   1.831E-04   2.606E-04   3.760E-04   5.492E-04
      8       9.845E-02   1.895E-02   5.492E-04   3.187E-04   2.111E-04   3.187E-04   5.492E-04   1.895E-02
gllpsf out=psf.img nl=8 ns=8 psf=(1.,0.,2.,2.,0.,10.)
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
Normalizing by total weight sum of = 104.24010
list psf.img
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
     Samp             1           2           3           4           5           6           7           8
   Line
      1       9.593E-03   1.439E-02   1.919E-02   1.679E-02   1.439E-02   1.679E-02   1.919E-02   1.439E-02
      2       1.439E-02   1.638E-02   1.862E-02   1.640E-02   1.409E-02   1.640E-02   1.862E-02   1.638E-02
      3       1.919E-02   1.862E-02   1.720E-02   1.534E-02   1.326E-02   1.534E-02   1.720E-02   1.862E-02
      4       1.679E-02   1.640E-02   1.534E-02   1.381E-02   1.199E-02   1.381E-02   1.534E-02   1.640E-02
      5       1.439E-02   1.409E-02   1.326E-02   1.199E-02   1.042E-02   1.199E-02   1.326E-02   1.409E-02
      6       1.679E-02   1.640E-02   1.534E-02   1.381E-02   1.199E-02   1.381E-02   1.534E-02   1.640E-02
      7       1.919E-02   1.862E-02   1.720E-02   1.534E-02   1.326E-02   1.534E-02   1.720E-02   1.862E-02
      8       1.439E-02   1.638E-02   1.862E-02   1.640E-02   1.409E-02   1.640E-02   1.862E-02   1.638E-02
gllpsf out=psf.img nl=16 ns=16
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  CLEAR
Normalizing by total weight sum of =   1.01205
fft22  inp=psf.img out=otf.img
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
TRANSFORM COMPLETED
list psf.img
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
     Samp             1           2           3           4           5           6           7           8           9          10
   Line
      1       5.039E-01   9.683E-02   6.344E-04   3.360E-04   2.174E-04   1.482E-04   1.087E-04   7.905E-05   5.731E-05   7.905E-05
      2       9.683E-02   1.864E-02   5.401E-04   3.135E-04   2.076E-04   1.443E-04   1.057E-04   7.722E-05   5.633E-05   7.722E-05
      3       6.344E-04   5.401E-04   3.699E-04   2.564E-04   1.801E-04   1.330E-04   9.715E-05   7.185E-05   5.342E-05   7.185E-05
      4       3.360E-04   3.135E-04   2.564E-04   1.982E-04   1.482E-04   1.154E-04   8.597E-05   6.414E-05   4.888E-05   6.414E-05
      5       2.174E-04   2.076E-04   1.801E-04   1.482E-04   1.223E-04   9.435E-05   7.362E-05   5.633E-05   4.414E-05   5.633E-05
      6       1.482E-04   1.443E-04   1.330E-04   1.154E-04   9.435E-05   7.722E-05   6.068E-05   4.819E-05   3.833E-05   4.819E-05
      7       1.087E-04   1.057E-04   9.715E-05   8.597E-05   7.362E-05   6.068E-05   4.964E-05   4.087E-05   3.360E-05   4.087E-05
      8       7.905E-05   7.722E-05   7.185E-05   6.414E-05   5.633E-05   4.819E-05   4.087E-05   3.439E-05   3.158E-05   3.439E-05
      9       5.731E-05   5.633E-05   5.342E-05   4.888E-05   4.414E-05   3.833E-05   3.360E-05   3.158E-05   2.679E-05   3.158E-05
     10       7.905E-05   7.722E-05   7.185E-05   6.414E-05   5.633E-05   4.819E-05   4.087E-05   3.439E-05   3.158E-05   3.439E-05
     11       1.087E-04   1.057E-04   9.715E-05   8.597E-05   7.362E-05   6.068E-05   4.964E-05   4.087E-05   3.360E-05   4.087E-05
     12       1.482E-04   1.443E-04   1.330E-04   1.154E-04   9.435E-05   7.722E-05   6.068E-05   4.819E-05   3.833E-05   4.819E-05
     13       2.174E-04   2.076E-04   1.801E-04   1.482E-04   1.223E-04   9.435E-05   7.362E-05   5.633E-05   4.414E-05   5.633E-05
     14       3.360E-04   3.135E-04   2.564E-04   1.982E-04   1.482E-04   1.154E-04   8.597E-05   6.414E-05   4.888E-05   6.414E-05
     15       6.344E-04   5.401E-04   3.699E-04   2.564E-04   1.801E-04   1.330E-04   9.715E-05   7.185E-05   5.342E-05   7.185E-05
     16       9.683E-02   1.864E-02   5.401E-04   3.135E-04   2.076E-04   1.443E-04   1.057E-04   7.722E-05   5.633E-05   7.722E-05

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
     Samp            11          12          13          14          15          16
   Line
      1       1.087E-04   1.482E-04   2.174E-04   3.360E-04   6.344E-04   9.683E-02
      2       1.057E-04   1.443E-04   2.076E-04   3.135E-04   5.401E-04   1.864E-02
      3       9.715E-05   1.330E-04   1.801E-04   2.564E-04   3.699E-04   5.401E-04
      4       8.597E-05   1.154E-04   1.482E-04   1.982E-04   2.564E-04   3.135E-04
      5       7.362E-05   9.435E-05   1.223E-04   1.482E-04   1.801E-04   2.076E-04
      6       6.068E-05   7.722E-05   9.435E-05   1.154E-04   1.330E-04   1.443E-04
      7       4.964E-05   6.068E-05   7.362E-05   8.597E-05   9.715E-05   1.057E-04
      8       4.087E-05   4.819E-05   5.633E-05   6.414E-05   7.185E-05   7.722E-05
      9       3.360E-05   3.833E-05   4.414E-05   4.888E-05   5.342E-05   5.633E-05
     10       4.087E-05   4.819E-05   5.633E-05   6.414E-05   7.185E-05   7.722E-05
     11       4.964E-05   6.068E-05   7.362E-05   8.597E-05   9.715E-05   1.057E-04
     12       6.068E-05   7.722E-05   9.435E-05   1.154E-04   1.330E-04   1.443E-04
     13       7.362E-05   9.435E-05   1.223E-04   1.482E-04   1.801E-04   2.076E-04
     14       8.597E-05   1.154E-04   1.482E-04   1.982E-04   2.564E-04   3.135E-04
     15       9.715E-05   1.330E-04   1.801E-04   2.564E-04   3.699E-04   5.401E-04
     16       1.057E-04   1.443E-04   2.076E-04   3.135E-04   5.401E-04   1.864E-02
list otf.img
Beginning VICAR task list

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:26:13 2011
     Samp                         1                       2                       3                       4                       5
   Line
      1       1.000E+00   0.000E+00   9.563E-01   1.537E-08   8.862E-01   2.235E-08   7.979E-01   1.397E-08   6.951E-01   0.000E+00
      2       9.563E-01   1.649E-08   9.295E-01   3.020E-08   8.670E-01   3.353E-08   7.807E-01   3.277E-08   6.805E-01   1.108E-08
      3       8.862E-01   2.247E-08   8.670E-01   3.740E-08   8.125E-01   3.725E-08   7.323E-01   2.948E-08   6.387E-01   1.482E-08
      4       7.979E-01   1.762E-08   7.807E-01   2.958E-08   7.323E-01   3.713E-08   6.605E-01   3.706E-08   5.762E-01   1.488E-08
      5       6.951E-01   0.000E+00   6.805E-01   1.119E-08   6.387E-01   1.490E-08   5.762E-01   1.486E-08   5.027E-01   0.000E+00
      6       5.941E-01  -7.852E-09   5.815E-01   3.653E-09   5.457E-01   7.450E-09   4.923E-01   7.393E-09   4.293E-01  -7.481E-09
      7       5.085E-01  -3.182E-08   4.978E-01  -2.243E-08   4.671E-01  -1.489E-08   4.212E-01  -1.482E-08   3.671E-01  -2.224E-08
      8       4.517E-01  -5.206E-08   4.420E-01  -4.281E-08   4.147E-01  -3.332E-08   3.739E-01  -3.320E-08   3.257E-01  -3.686E-08
      9       4.315E-01   0.000E+00   4.224E-01   5.586E-09   3.964E-01   1.118E-08   3.573E-01   7.457E-09   3.112E-01   0.000E+00
     10       4.517E-01  -1.578E-08   4.420E-01  -9.303E-09   4.147E-01   6.548E-11   3.739E-01  -7.345E-09   3.257E-01  -1.105E-08
     11       5.085E-01  -2.247E-08   4.978E-01  -1.310E-08   4.671E-01  -7.443E-09   4.212E-01  -7.395E-09   3.671E-01  -1.482E-08
     12       5.941E-01  -1.966E-08   5.815E-01  -1.145E-08   5.457E-01  -6.366E-11   4.923E-01  -8.185E-11   4.293E-01  -1.500E-08
     13       6.951E-01   0.000E+00   6.805E-01   1.119E-08   6.387E-01   1.490E-08   5.762E-01   1.486E-08   5.027E-01   0.000E+00
     14       7.979E-01   7.148E-09   7.807E-01   2.230E-08   7.323E-01   2.974E-08   6.605E-01   1.477E-08   5.762E-01   7.446E-09
     15       8.862E-01   3.182E-08   8.670E-01   4.857E-08   8.125E-01   4.469E-08   7.323E-01   3.693E-08   6.387E-01   2.224E-08
     16       9.563E-01   5.409E-08   9.295E-01   6.768E-08   8.670E-01   7.449E-08   7.807E-01   6.628E-08   6.805E-01   3.698E-08

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:26:13 2011
     Samp                         6                       7                       8                       9                      10
   Line
      1       5.941E-01  -1.537E-08   5.085E-01  -2.980E-08   4.517E-01  -5.122E-08   4.315E-01   0.000E+00   4.517E-01  -1.444E-08
      2       5.815E-01   3.429E-09   4.978E-01  -1.863E-08   4.420E-01  -4.011E-08   4.224E-01   6.567E-09   4.420E-01  -7.049E-09
      3       5.457E-01   7.305E-09   4.671E-01  -1.491E-08   4.147E-01  -3.693E-08   3.964E-01   7.524E-09   4.147E-01  -7.305E-09
      4       4.923E-01  -1.073E-10   4.212E-01  -7.576E-09   3.739E-01  -2.994E-08   3.573E-01   1.125E-08   3.739E-01  -2.237E-10
      5       4.293E-01  -7.465E-09   3.671E-01  -2.235E-08   3.257E-01  -3.721E-08   3.112E-01   0.000E+00   3.257E-01  -1.116E-08
      6       3.664E-01  -1.494E-08   3.131E-01  -2.608E-08   2.775E-01  -3.731E-08   2.650E-01  -7.459E-09   2.775E-01  -1.870E-08
      7       3.131E-01  -2.227E-08   2.673E-01  -3.352E-08   2.367E-01  -4.105E-08   2.259E-01  -1.314E-08   2.367E-01  -2.243E-08
      8       2.775E-01  -3.693E-08   2.367E-01  -4.450E-08   2.093E-01  -4.840E-08   1.998E-01  -2.269E-08   2.093E-01  -3.164E-08
      9       2.650E-01  -3.723E-09   2.259E-01  -1.490E-08   1.998E-01  -2.236E-08   1.906E-01   0.000E+00   1.998E-01  -5.590E-09
     10       2.775E-01  -1.107E-08   2.367E-01  -2.601E-08   2.093E-01  -2.979E-08   1.998E-01  -6.619E-09   2.093E-01  -1.303E-08
     11       3.131E-01  -1.484E-08   2.673E-01  -2.607E-08   2.367E-01  -3.545E-08   2.259E-01  -7.524E-09   2.367E-01  -1.682E-08
     12       3.664E-01  -2.242E-08   3.131E-01  -3.359E-08   2.775E-01  -4.123E-08   2.650E-01  -1.113E-08   2.775E-01  -1.890E-08
     13       4.293E-01  -7.465E-09   3.671E-01  -2.235E-08   3.257E-01  -3.721E-08   3.112E-01   0.000E+00   3.257E-01  -1.116E-08
     14       4.923E-01   7.397E-09   4.212E-01  -2.241E-08   3.739E-01  -3.723E-08   3.573E-01   7.512E-09   3.739E-01  -7.504E-09
     15       5.457E-01   1.476E-08   4.671E-01  -7.460E-09   4.147E-01  -3.321E-08   3.964E-01   1.314E-08   4.147E-01  -3.580E-09
     16       5.815E-01   2.204E-08   4.978E-01  -7.469E-09   4.420E-01  -2.499E-08   4.224E-01   2.257E-08   4.420E-01   8.073E-09

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:26:13 2011
     Samp                        11                      12                      13                      14                      15
   Line
      1       5.085E-01  -2.235E-08   5.941E-01  -1.583E-08   6.951E-01   0.000E+00   7.979E-01   1.444E-08   8.862E-01   2.980E-08
      2       4.978E-01  -1.118E-08   5.815E-01  -1.194E-08   6.805E-01   1.108E-08   7.807E-01   1.833E-08   8.670E-01   4.098E-08
      3       4.671E-01  -7.458E-09   5.457E-01  -3.203E-10   6.387E-01   1.482E-08   7.323E-01   2.221E-08   8.125E-01   4.470E-08
      4       4.212E-01  -7.576E-09   4.923E-01  -7.645E-09   5.762E-01   1.488E-08   6.605E-01   2.970E-08   7.323E-01   3.713E-08
      5       3.671E-01  -1.490E-08   4.293E-01  -1.494E-08   5.027E-01   0.000E+00   5.762E-01   7.436E-09   6.387E-01   2.235E-08
      6       3.131E-01  -2.235E-08   3.664E-01  -2.241E-08   4.293E-01  -7.481E-09   4.923E-01  -4.275E-11   5.457E-01   1.117E-08
      7       2.673E-01  -2.979E-08   3.131E-01  -2.973E-08   3.671E-01  -2.224E-08   4.212E-01  -2.227E-08   4.671E-01  -1.117E-08
      8       2.367E-01  -4.077E-08   2.775E-01  -4.065E-08   3.257E-01  -3.686E-08   3.739E-01  -3.693E-08   4.147E-01  -2.959E-08
      9       2.259E-01  -1.118E-08   2.650E-01  -7.444E-09   3.112E-01   0.000E+00   3.573E-01   3.727E-09   3.964E-01   1.490E-08
     10       2.367E-01  -2.229E-08   2.775E-01  -1.480E-08   3.257E-01  -1.105E-08   3.739E-01  -1.107E-08   4.147E-01   3.791E-09
     11       2.673E-01  -2.234E-08   3.131E-01  -2.230E-08   3.671E-01  -1.482E-08   4.212E-01  -1.484E-08   4.671E-01  -3.718E-09
     12       3.131E-01  -2.987E-08   3.664E-01  -2.988E-08   4.293E-01  -1.500E-08   4.923E-01  -7.518E-09   5.457E-01   3.662E-09
     13       3.671E-01  -1.490E-08   4.293E-01  -1.494E-08   5.027E-01   0.000E+00   5.762E-01   7.436E-09   6.387E-01   2.235E-08
     14       4.212E-01  -1.496E-08   4.923E-01  -1.264E-10   5.762E-01   7.446E-09   6.605E-01   7.397E-09   7.323E-01   3.719E-08
     15       4.671E-01  -8.924E-12   5.457E-01   7.130E-09   6.387E-01   2.224E-08   7.323E-01   2.966E-08   8.125E-01   5.215E-08
     16       4.978E-01  -1.819E-11   5.815E-01   6.676E-09   6.805E-01   3.698E-08   7.807E-01   5.184E-08   8.670E-01   8.194E-08

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:12 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:26:13 2011
     Samp                        16
   Line
      1       9.563E-01   5.309E-08
      2       9.295E-01   6.420E-08
      3       8.670E-01   6.738E-08
      4       7.807E-01   5.947E-08
      5       6.805E-01   3.730E-08
      6       5.815E-01   2.229E-08
      7       4.978E-01  -3.802E-09
      8       4.420E-01  -2.605E-08
      9       4.224E-01   2.235E-08
     10       4.420E-01   7.461E-09
     11       4.978E-01   5.533E-09
     12       5.815E-01   1.092E-08
     13       6.805E-01   3.730E-08
     14       7.807E-01   5.217E-08
     15       8.670E-01   7.855E-08
     16       9.295E-01   1.017E-07
if ($syschar(1)="UNIX")
  let PATH="/project/test_work/testdata/gll/"
end-if
adespike "/project/test_work/testdata/gll/"s0202556100.sos 6100.spk tol=600
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            0
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                0
adespike "/project/test_work/testdata/gll/"s0202556200.sos xa tol=400
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            1
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                9
adespike xa 6200.spk tol=400
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            1
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                0
adespike "/project/test_work/testdata/gll/"s0202556245.sos  6245.spk tol=400
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            2
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                3
gllpsf out=psf nl=128 ns=256 filt=GRN
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  GRN
Normalizing by total weight sum of =   1.14139
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:16 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       7.310E-01   3.429E-06   5.523E-07   2.256E-07   1.588E-07   1.390E-07   1.624E-07   2.437E-07   7.291E-07   4.422E-06
     11       8.934E-06   3.004E-06   5.316E-07   2.227E-07   1.584E-07   1.386E-07   1.620E-07   2.406E-07   6.603E-07   3.835E-06
     21       4.873E-06   2.201E-06   4.718E-07   2.152E-07   1.571E-07   1.375E-07   1.606E-07   2.317E-07   5.523E-07   2.756E-06
     31       2.707E-06   1.291E-06   3.786E-07   2.069E-07   1.550E-07   1.358E-07   1.585E-07   2.173E-07   4.526E-07   1.516E-06
     41       1.263E-06   7.487E-07   3.133E-07   1.958E-07   1.521E-07   1.354E-07   1.555E-07   2.054E-07   3.499E-07   8.860E-07
     51       5.956E-07   4.579E-07   2.520E-07   1.823E-07   1.485E-07   1.354E-07   1.518E-07   1.914E-07   2.698E-07   4.954E-07
     61       3.790E-07   3.158E-07   2.193E-07   1.667E-07   1.443E-07   1.354E-07   1.474E-07   1.752E-07   2.308E-07   3.332E-07
     71       4.223E-07   3.372E-07   2.261E-07   1.700E-07   1.452E-07   1.354E-07   1.484E-07   1.786E-07   2.378E-07   3.552E-07
     81       7.291E-07   4.962E-07   2.582E-07   1.852E-07   1.493E-07   1.354E-07   1.526E-07   1.944E-07   2.865E-07   5.349E-07
     91       1.444E-06   8.598E-07   3.273E-07   1.983E-07   1.528E-07   1.354E-07   1.561E-07   2.080E-07   3.647E-07   1.002E-06
    101       2.978E-06   1.425E-06   3.994E-07   2.088E-07   1.555E-07   1.362E-07   1.590E-07   2.205E-07   4.750E-07   1.785E-06
    111       5.414E-06   2.414E-06   4.867E-07   2.164E-07   1.574E-07   1.378E-07   1.610E-07   2.339E-07   5.682E-07   2.940E-06
    121       1.083E-05   3.122E-06   5.390E-07   2.238E-07   1.585E-07   1.387E-07   1.621E-07   2.417E-07   6.849E-07   4.040E-06
copy 6100.spk 6100.soscut (280,320,128,256)
Beginning VICAR task copy
 COPY VERSION 12-JUL-1993
gllpsf filt=VLT out=psf nl=128 ns=256
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  VLT
Normalizing by total weight sum of =   1.25280
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:17 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       8.222E-01   2.466E-06   8.419E-07   3.256E-07   1.842E-07   1.381E-07   1.973E-07   3.683E-07   9.866E-07   3.124E-06
     11       1.069E-05   2.232E-06   8.121E-07   3.188E-07   1.826E-07   1.375E-07   1.957E-07   3.611E-07   9.442E-07   2.686E-06
     21       3.618E-06   1.743E-06   7.259E-07   3.008E-07   1.779E-07   1.355E-07   1.908E-07   3.400E-07   8.419E-07   2.017E-06
     31       1.973E-06   1.340E-06   5.914E-07   2.807E-07   1.702E-07   1.323E-07   1.828E-07   3.058E-07   6.981E-07   1.463E-06
     41       1.315E-06   9.986E-07   4.906E-07   2.538E-07   1.621E-07   1.297E-07   1.720E-07   2.771E-07   5.471E-07   1.083E-06
     51       9.044E-07   7.058E-07   3.882E-07   2.275E-07   1.556E-07   1.270E-07   1.615E-07   2.430E-07   4.235E-07   7.599E-07
     61       5.920E-07   4.944E-07   3.106E-07   2.039E-07   1.479E-07   1.237E-07   1.535E-07   2.168E-07   3.380E-07   5.213E-07
     71       6.544E-07   5.275E-07   3.267E-07   2.088E-07   1.495E-07   1.244E-07   1.552E-07   2.219E-07   3.546E-07   5.552E-07
     81       9.866E-07   7.610E-07   4.029E-07   2.319E-07   1.570E-07   1.276E-07   1.629E-07   2.502E-07   4.494E-07   8.169E-07
     91       1.398E-06   1.067E-06   5.123E-07   2.597E-07   1.632E-07   1.302E-07   1.744E-07   2.832E-07   5.699E-07   1.155E-06
    101       2.220E-06   1.398E-06   6.213E-07   2.853E-07   1.720E-07   1.331E-07   1.847E-07   3.136E-07   7.304E-07   1.512E-06
    111       4.275E-06   1.840E-06   7.473E-07   3.039E-07   1.791E-07   1.360E-07   1.920E-07   3.453E-07   8.649E-07   2.185E-06
    121       1.480E-05   2.285E-06   8.228E-07   3.212E-07   1.832E-07   1.377E-07   1.963E-07   3.637E-07   9.594E-07   2.859E-06
fft22  inp=psf out=otf
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
fft22  inp=6100.soscut out=fftpix nl=128 ns=256
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
Beginning VICAR task wiener
WIENER version Nov 1996
fft22 inp=fixfftpix out=6100.scat mode=inverse format=half
Beginning VICAR task fft22
FFT22 version 1-JUL-94
INVERSE TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
copy 6200.spk 6200.soscut (280,320,128,256)
Beginning VICAR task copy
 COPY VERSION 12-JUL-1993
gllpsf filt=968 out=psf nl=128 ns=256
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  968
Normalizing by total weight sum of =   1.20655
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:21 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       3.329E-01   7.683E-06   1.178E-06   7.888E-07   4.678E-07   3.278E-07   4.951E-07   8.639E-07   1.400E-06   1.195E-05
     11       6.488E-05   6.317E-06   1.170E-06   7.768E-07   4.645E-07   3.258E-07   4.917E-07   8.513E-07   1.294E-06   9.249E-06
     21       1.537E-05   3.892E-06   1.146E-06   7.432E-07   4.548E-07   3.197E-07   4.816E-07   8.141E-07   1.178E-06   5.174E-06
     31       5.037E-06   2.271E-06   1.109E-06   6.964E-07   4.389E-07   3.098E-07   4.651E-07   7.541E-07   1.139E-06   2.697E-06
     41       2.220E-06   1.430E-06   1.014E-06   6.336E-07   4.171E-07   3.054E-07   4.425E-07   6.879E-07   1.067E-06   1.641E-06
     51       1.195E-06   1.141E-06   8.989E-07   5.704E-07   3.900E-07   3.026E-07   4.145E-07   6.082E-07   9.508E-07   1.156E-06
     61       1.110E-06   1.018E-06   7.625E-07   5.114E-07   3.582E-07   2.992E-07   3.816E-07   5.436E-07   8.106E-07   1.043E-06
     71       1.127E-06   1.049E-06   7.907E-07   5.238E-07   3.648E-07   2.999E-07   3.886E-07   5.564E-07   8.398E-07   1.075E-06
     81       1.400E-06   1.156E-06   9.246E-07   5.813E-07   3.958E-07   3.032E-07   4.205E-07   6.252E-07   9.752E-07   1.171E-06
     91       2.561E-06   1.600E-06   1.035E-06   6.473E-07   4.219E-07   3.060E-07   4.475E-07   7.023E-07   1.089E-06   1.819E-06
    101       6.232E-06   2.525E-06   1.118E-06   7.071E-07   4.425E-07   3.121E-07   4.689E-07   7.678E-07   1.148E-06   3.003E-06
    111       1.878E-05   4.259E-06   1.152E-06   7.505E-07   4.573E-07   3.213E-07   4.842E-07   8.234E-07   1.184E-06   5.941E-06
    121       1.024E-04   6.708E-06   1.173E-06   7.811E-07   4.657E-07   3.265E-07   4.929E-07   8.558E-07   1.332E-06   1.040E-05
fft22  inp=psf out=otf
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
fft22  inp=6200.soscut out=fftpix nl=128 ns=256
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
Beginning VICAR task wiener
WIENER version Nov 1996
fft22  inp=fixfftpix out=6200.scat mode=inverse format=half
Beginning VICAR task fft22
FFT22 version 1-JUL-94
INVERSE TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
copy "/project/test_work/testdata/gll/"s0202556245.sos 6245.soscut (280,320,128,256)
Beginning VICAR task copy
 COPY VERSION 12-JUL-1993
gllpsf filt=889 out=psf nl=128 ns=256
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  889
Normalizing by total weight sum of =   1.09793
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:26:24 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       2.908E-01   4.034E-06   1.216E-06   4.090E-07   2.233E-07   1.670E-07   2.345E-07   4.766E-07   1.445E-06   5.816E-06
     11       3.190E-05   3.431E-06   1.169E-06   3.982E-07   2.219E-07   1.662E-07   2.331E-07   4.652E-07   1.377E-06   4.707E-06
     21       7.411E-06   2.645E-06   1.035E-06   3.708E-07   2.179E-07   1.640E-07   2.290E-07   4.317E-07   1.216E-06   3.052E-06
     31       3.002E-06   1.998E-06   8.246E-07   3.451E-07   2.113E-07   1.604E-07   2.221E-07   3.778E-07   9.912E-07   2.233E-06
     41       1.970E-06   1.464E-06   6.678E-07   3.106E-07   2.024E-07   1.574E-07   2.129E-07   3.405E-07   7.557E-07   1.599E-06
     51       1.313E-06   1.003E-06   5.080E-07   2.759E-07   1.912E-07   1.543E-07   2.013E-07   2.967E-07   5.635E-07   1.088E-06
     61       8.256E-07   6.738E-07   3.854E-07   2.435E-07   1.781E-07   1.505E-07   1.878E-07   2.612E-07   4.287E-07   7.156E-07
     71       9.231E-07   7.253E-07   4.108E-07   2.503E-07   1.808E-07   1.513E-07   1.906E-07   2.682E-07   4.549E-07   7.684E-07
     81       1.445E-06   1.089E-06   5.312E-07   2.819E-07   1.936E-07   1.549E-07   2.038E-07   3.060E-07   6.037E-07   1.177E-06
     91       2.158E-06   1.573E-06   7.016E-07   3.181E-07   2.043E-07   1.580E-07   2.149E-07   3.483E-07   7.912E-07   1.713E-06
    101       3.377E-06   2.138E-06   8.714E-07   3.510E-07   2.129E-07   1.612E-07   2.237E-07   3.901E-07   1.042E-06   2.382E-06
    111       9.381E-06   2.791E-06   1.068E-06   3.748E-07   2.189E-07   1.646E-07   2.300E-07   4.401E-07   1.252E-06   3.297E-06
    121       5.441E-05   3.676E-06   1.186E-06   4.021E-07   2.224E-07   1.665E-07   2.336E-07   4.693E-07   1.401E-06   5.061E-06
fft22  inp=psf out=otf
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
fft22  inp=6245.soscut out=fftpix nl=128 ns=256
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
Beginning VICAR task wiener
WIENER version Nov 1996
fft22  inp=fixfftpix out=6245.scat mode=inverse format=half
Beginning VICAR task fft22
FFT22 version 1-JUL-94
INVERSE TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
if ($syschar(1)="UNIX")
  ush rm psf.img
  ush rm otf.img
  ush rm *soscut
  ush rm psf
  ush rm fftpix
  ush rm otf
  ush rm fixfftpix
  ush rm *spk
else
end-if
  write "The tester should diplay the input and the output from "
The tester should diplay the input and the output from 
  write "the Ida test as shown below."
the Ida test as shown below.
  write "use xwb0"
use xwb0
  write "vids"
vids
  write "jdisp /project/test_work/testdata/gll/s0202556100.sos"
jdisp /project/test_work/testdata/gll/s0202556100.sos
  write "jdisp 6100.scat"
jdisp 6100.scat
  write "jdisp /project/test_work/testdata/gll/s0202556200.sos"
jdisp /project/test_work/testdata/gll/s0202556200.sos
  write "jdisp 6200.scat"
jdisp 6200.scat
  write "jdisp /project/test_work/testdata/gll/s0202556245.sos"
jdisp /project/test_work/testdata/gll/s0202556245.sos
  write "jdisp 6245.scat"
jdisp 6245.scat
let $echo="no"
exit
slogoff
$!-----------------------------------------------------------------------------
$ create tstgllpsf.log_linux
tstgllpsf
gllpsf out=psf.img nl=8 ns=8
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  CLEAR
Normalizing by total weight sum of =   0.99540
list psf.img
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp             1           2           3           4           5           6           7           8
   Line
      1       5.124E-01   9.845E-02   6.450E-04   3.416E-04   2.210E-04   3.416E-04   6.450E-04   9.845E-02
      2       9.845E-02   1.895E-02   5.492E-04   3.187E-04   2.111E-04   3.187E-04   5.492E-04   1.895E-02
      3       6.450E-04   5.492E-04   3.760E-04   2.606E-04   1.831E-04   2.606E-04   3.760E-04   5.492E-04
      4       3.416E-04   3.187E-04   2.606E-04   2.015E-04   1.507E-04   2.015E-04   2.606E-04   3.187E-04
      5       2.210E-04   2.111E-04   1.831E-04   1.507E-04   1.243E-04   1.507E-04   1.831E-04   2.111E-04
      6       3.416E-04   3.187E-04   2.606E-04   2.015E-04   1.507E-04   2.015E-04   2.606E-04   3.187E-04
      7       6.450E-04   5.492E-04   3.760E-04   2.606E-04   1.831E-04   2.606E-04   3.760E-04   5.492E-04
      8       9.845E-02   1.895E-02   5.492E-04   3.187E-04   2.111E-04   3.187E-04   5.492E-04   1.895E-02
gllpsf out=psf.img nl=8 ns=8 psf=(1.,0.,2.,2.,0.,10.)
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
Normalizing by total weight sum of = 104.24011
list psf.img
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp             1           2           3           4           5           6           7           8
   Line
      1       9.593E-03   1.439E-02   1.919E-02   1.679E-02   1.439E-02   1.679E-02   1.919E-02   1.439E-02
      2       1.439E-02   1.638E-02   1.862E-02   1.640E-02   1.409E-02   1.640E-02   1.862E-02   1.638E-02
      3       1.919E-02   1.862E-02   1.720E-02   1.534E-02   1.326E-02   1.534E-02   1.720E-02   1.862E-02
      4       1.679E-02   1.640E-02   1.534E-02   1.381E-02   1.199E-02   1.381E-02   1.534E-02   1.640E-02
      5       1.439E-02   1.409E-02   1.326E-02   1.199E-02   1.042E-02   1.199E-02   1.326E-02   1.409E-02
      6       1.679E-02   1.640E-02   1.534E-02   1.381E-02   1.199E-02   1.381E-02   1.534E-02   1.640E-02
      7       1.919E-02   1.862E-02   1.720E-02   1.534E-02   1.326E-02   1.534E-02   1.720E-02   1.862E-02
      8       1.439E-02   1.638E-02   1.862E-02   1.640E-02   1.409E-02   1.640E-02   1.862E-02   1.638E-02
gllpsf out=psf.img nl=16 ns=16
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  CLEAR
Normalizing by total weight sum of =   1.01205
fft22  inp=psf.img out=otf.img
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
TRANSFORM COMPLETED
list psf.img
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp             1           2           3           4           5           6           7           8           9          10
   Line
      1       5.039E-01   9.683E-02   6.344E-04   3.360E-04   2.174E-04   1.482E-04   1.087E-04   7.905E-05   5.731E-05   7.905E-05
      2       9.683E-02   1.864E-02   5.401E-04   3.135E-04   2.076E-04   1.443E-04   1.057E-04   7.722E-05   5.633E-05   7.722E-05
      3       6.344E-04   5.401E-04   3.699E-04   2.564E-04   1.801E-04   1.330E-04   9.715E-05   7.185E-05   5.342E-05   7.185E-05
      4       3.360E-04   3.135E-04   2.564E-04   1.982E-04   1.482E-04   1.154E-04   8.597E-05   6.414E-05   4.888E-05   6.414E-05
      5       2.174E-04   2.076E-04   1.801E-04   1.482E-04   1.223E-04   9.435E-05   7.362E-05   5.633E-05   4.414E-05   5.633E-05
      6       1.482E-04   1.443E-04   1.330E-04   1.154E-04   9.435E-05   7.722E-05   6.068E-05   4.819E-05   3.833E-05   4.819E-05
      7       1.087E-04   1.057E-04   9.715E-05   8.597E-05   7.362E-05   6.068E-05   4.964E-05   4.087E-05   3.360E-05   4.087E-05
      8       7.905E-05   7.722E-05   7.185E-05   6.414E-05   5.633E-05   4.819E-05   4.087E-05   3.439E-05   3.158E-05   3.439E-05
      9       5.731E-05   5.633E-05   5.342E-05   4.888E-05   4.414E-05   3.833E-05   3.360E-05   3.158E-05   2.679E-05   3.158E-05
     10       7.905E-05   7.722E-05   7.185E-05   6.414E-05   5.633E-05   4.819E-05   4.087E-05   3.439E-05   3.158E-05   3.439E-05
     11       1.087E-04   1.057E-04   9.715E-05   8.597E-05   7.362E-05   6.068E-05   4.964E-05   4.087E-05   3.360E-05   4.087E-05
     12       1.482E-04   1.443E-04   1.330E-04   1.154E-04   9.435E-05   7.722E-05   6.068E-05   4.819E-05   3.833E-05   4.819E-05
     13       2.174E-04   2.076E-04   1.801E-04   1.482E-04   1.223E-04   9.435E-05   7.362E-05   5.633E-05   4.414E-05   5.633E-05
     14       3.360E-04   3.135E-04   2.564E-04   1.982E-04   1.482E-04   1.154E-04   8.597E-05   6.414E-05   4.888E-05   6.414E-05
     15       6.344E-04   5.401E-04   3.699E-04   2.564E-04   1.801E-04   1.330E-04   9.715E-05   7.185E-05   5.342E-05   7.185E-05
     16       9.683E-02   1.864E-02   5.401E-04   3.135E-04   2.076E-04   1.443E-04   1.057E-04   7.722E-05   5.633E-05   7.722E-05

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp            11          12          13          14          15          16
   Line
      1       1.087E-04   1.482E-04   2.174E-04   3.360E-04   6.344E-04   9.683E-02
      2       1.057E-04   1.443E-04   2.076E-04   3.135E-04   5.401E-04   1.864E-02
      3       9.715E-05   1.330E-04   1.801E-04   2.564E-04   3.699E-04   5.401E-04
      4       8.597E-05   1.154E-04   1.482E-04   1.982E-04   2.564E-04   3.135E-04
      5       7.362E-05   9.435E-05   1.223E-04   1.482E-04   1.801E-04   2.076E-04
      6       6.068E-05   7.722E-05   9.435E-05   1.154E-04   1.330E-04   1.443E-04
      7       4.964E-05   6.068E-05   7.362E-05   8.597E-05   9.715E-05   1.057E-04
      8       4.087E-05   4.819E-05   5.633E-05   6.414E-05   7.185E-05   7.722E-05
      9       3.360E-05   3.833E-05   4.414E-05   4.888E-05   5.342E-05   5.633E-05
     10       4.087E-05   4.819E-05   5.633E-05   6.414E-05   7.185E-05   7.722E-05
     11       4.964E-05   6.068E-05   7.362E-05   8.597E-05   9.715E-05   1.057E-04
     12       6.068E-05   7.722E-05   9.435E-05   1.154E-04   1.330E-04   1.443E-04
     13       7.362E-05   9.435E-05   1.223E-04   1.482E-04   1.801E-04   2.076E-04
     14       8.597E-05   1.154E-04   1.482E-04   1.982E-04   2.564E-04   3.135E-04
     15       9.715E-05   1.330E-04   1.801E-04   2.564E-04   3.699E-04   5.401E-04
     16       1.057E-04   1.443E-04   2.076E-04   3.135E-04   5.401E-04   1.864E-02
list otf.img
Beginning VICAR task list

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp                         1                       2                       3                       4                       5
   Line
      1       1.000E+00   0.000E+00   9.563E-01   1.134E-08   8.862E-01   1.490E-08   7.979E-01   1.423E-08   6.951E-01   0.000E+00
      2       9.563E-01   1.065E-08   9.295E-01   2.256E-08   8.670E-01   2.979E-08   7.807E-01   2.191E-08   6.805E-01   7.378E-09
      3       8.862E-01   2.054E-08   8.670E-01   2.986E-08   8.125E-01   3.725E-08   7.323E-01   2.963E-08   6.387E-01   1.488E-08
      4       7.979E-01   1.801E-08   7.807E-01   2.967E-08   7.323E-01   2.972E-08   6.605E-01   2.964E-08   5.762E-01   1.481E-08
      5       6.951E-01   0.000E+00   6.805E-01   7.458E-09   6.387E-01   7.451E-09   5.762E-01   1.487E-08   5.027E-01   0.000E+00
      6       5.941E-01  -1.140E-08   5.815E-01  -3.810E-09   5.457E-01  -2.164E-11   4.923E-01   1.754E-11   4.293E-01  -7.401E-09
      7       5.085E-01  -2.057E-08   4.978E-01  -1.494E-08   4.671E-01  -1.117E-08   4.212E-01  -7.414E-09   3.671E-01  -1.485E-08
      8       4.517E-01  -3.538E-08   4.420E-01  -2.976E-08   4.147E-01  -2.591E-08   3.739E-01  -2.213E-08   3.257E-01  -2.583E-08
      9       4.315E-01   0.000E+00   4.224E-01   5.587E-09   3.964E-01   7.451E-09   3.573E-01   7.455E-09   3.112E-01   0.000E+00
     10       4.517E-01  -1.032E-08   4.420E-01  -3.735E-09   4.147E-01  -3.674E-09   3.739E-01   7.466E-11   3.257E-01  -7.364E-09
     11       5.085E-01  -2.054E-08   4.978E-01  -1.492E-08   4.671E-01  -1.117E-08   4.212E-01  -7.434E-09   3.671E-01  -1.488E-08
     12       5.941E-01  -1.936E-08   5.815E-01  -1.141E-08   5.457E-01  -7.530E-09   4.923E-01  -7.468E-09   4.293E-01  -1.487E-08
     13       6.951E-01   0.000E+00   6.805E-01   7.458E-09   6.387E-01   7.451E-09   5.762E-01   1.487E-08   5.027E-01   0.000E+00
     14       7.979E-01   1.107E-08   7.807E-01   2.236E-08   7.323E-01   2.233E-08   6.605E-01   2.222E-08   5.762E-01   7.387E-09
     15       8.862E-01   2.057E-08   8.670E-01   2.988E-08   8.125E-01   3.725E-08   7.323E-01   2.961E-08   6.387E-01   1.485E-08
     16       9.563E-01   3.672E-08   9.295E-01   4.516E-08   8.670E-01   4.842E-08   7.807E-01   4.791E-08   6.805E-01   2.589E-08

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp                         6                       7                       8                       9                      10
   Line
      1       5.941E-01  -1.678E-10   5.085E-01  -2.235E-08   4.517E-01  -3.658E-08   4.315E-01   0.000E+00   4.517E-01  -1.101E-08
      2       5.815E-01  -1.513E-10   4.978E-01  -1.491E-08   4.420E-01  -3.303E-08   4.224E-01   4.724E-09   4.420E-01  -7.245E-09
      3       5.457E-01   7.391E-09   4.671E-01  -7.456E-09   4.147E-01  -2.218E-08   3.964E-01   9.334E-09   4.147E-01   5.912E-11
      4       4.923E-01   7.346E-09   4.212E-01  -7.930E-11   3.739E-01  -1.871E-08   3.573E-01   1.124E-08   3.739E-01  -1.366E-10
      5       4.293E-01  -7.458E-09   3.671E-01  -7.451E-09   3.257E-01  -2.232E-08   3.112E-01   0.000E+00   3.257E-01  -7.444E-09
      6       3.664E-01  -1.487E-08   3.131E-01  -1.492E-08   2.775E-01  -2.615E-08   2.650E-01  -3.784E-09   2.775E-01  -1.126E-08
      7       3.131E-01  -1.486E-08   2.673E-01  -1.862E-08   2.367E-01  -2.798E-08   2.259E-01  -9.363E-09   2.367E-01  -1.494E-08
      8       2.775E-01  -2.586E-08   2.367E-01  -2.591E-08   2.093E-01  -3.349E-08   1.998E-01  -1.695E-08   2.093E-01  -2.231E-08
      9       2.650E-01  -3.724E-09   2.259E-01  -7.451E-09   1.998E-01  -1.491E-08   1.906E-01   0.000E+00   1.998E-01  -5.589E-09
     10       2.775E-01  -1.110E-08   2.367E-01  -1.112E-08   2.093E-01  -2.236E-08   1.998E-01  -4.726E-09   2.093E-01  -1.119E-08
     11       3.131E-01  -1.488E-08   2.673E-01  -1.862E-08   2.367E-01  -2.796E-08   2.259E-01  -9.334E-09   2.367E-01  -1.492E-08
     12       3.664E-01  -2.236E-08   3.131E-01  -2.243E-08   2.775E-01  -3.375E-08   2.650E-01  -1.123E-08   2.775E-01  -1.886E-08
     13       4.293E-01  -7.458E-09   3.671E-01  -7.451E-09   3.257E-01  -2.232E-08   3.112E-01   0.000E+00   3.257E-01  -7.444E-09
     14       4.923E-01  -7.291E-11   4.212E-01  -7.469E-09   3.739E-01  -2.601E-08   3.573E-01   3.786E-09   3.739E-01  -7.442E-09
     15       5.457E-01   7.371E-09   4.671E-01  -7.456E-09   4.147E-01  -2.216E-08   3.964E-01   9.363E-09   4.147E-01   7.965E-11
     16       5.815E-01   1.095E-08   4.978E-01   3.718E-09   4.420E-01  -1.415E-08   4.224E-01   1.694E-08   4.420E-01   7.904E-09

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp                        11                      12                      13                      14                      15
   Line
      1       5.085E-01  -1.490E-08   5.941E-01  -1.557E-08   6.951E-01   0.000E+00   7.979E-01  -1.678E-10   8.862E-01   2.235E-08
      2       4.978E-01  -1.491E-08   5.815E-01  -7.896E-09   6.805E-01   7.378E-09   7.807E-01   1.475E-08   8.670E-01   2.979E-08
      3       4.671E-01  -7.456E-09   5.457E-01  -1.750E-10   6.387E-01   1.488E-08   7.323E-01   2.229E-08   8.125E-01   3.725E-08
      4       4.212E-01  -7.930E-11   4.923E-01  -1.609E-10   5.762E-01   1.481E-08   6.605E-01   2.225E-08   7.323E-01   2.972E-08
      5       3.671E-01  -7.451E-09   4.293E-01  -1.493E-08   5.027E-01   0.000E+00   5.762E-01   7.444E-09   6.387E-01   7.451E-09
      6       3.131E-01  -1.492E-08   3.664E-01  -1.488E-08   4.293E-01  -7.401E-09   4.923E-01   2.824E-11   5.457E-01  -2.164E-11
      7       2.673E-01  -1.862E-08   3.131E-01  -2.231E-08   3.671E-01  -1.485E-08   4.212E-01  -1.486E-08   4.671E-01  -1.117E-08
      8       2.367E-01  -2.591E-08   2.775E-01  -2.958E-08   3.257E-01  -2.583E-08   3.739E-01  -2.586E-08   4.147E-01  -2.591E-08
      9       2.259E-01  -7.451E-09   2.650E-01  -7.446E-09   3.112E-01   0.000E+00   3.573E-01   3.726E-09   3.964E-01   7.451E-09
     10       2.367E-01  -1.112E-08   2.775E-01  -1.483E-08   3.257E-01  -7.364E-09   3.739E-01  -3.650E-09   4.147E-01  -3.674E-09
     11       2.673E-01  -1.862E-08   3.131E-01  -2.234E-08   3.671E-01  -1.488E-08   4.212E-01  -1.488E-08   4.671E-01  -1.117E-08
     12       3.131E-01  -2.243E-08   3.664E-01  -2.237E-08   4.293E-01  -1.487E-08   4.923E-01  -7.458E-09   5.457E-01  -7.530E-09
     13       3.671E-01  -7.451E-09   4.293E-01  -1.493E-08   5.027E-01   0.000E+00   5.762E-01   7.444E-09   6.387E-01   7.451E-09
     14       4.212E-01  -7.469E-09   4.923E-01  -7.580E-09   5.762E-01   7.387E-09   6.605E-01   1.483E-08   7.323E-01   2.233E-08
     15       4.671E-01  -7.456E-09   5.457E-01  -1.957E-10   6.387E-01   1.485E-08   7.323E-01   2.227E-08   8.125E-01   3.725E-08
     16       4.978E-01   3.718E-09   5.815E-01   3.203E-09   6.805E-01   2.589E-08   7.807E-01   4.075E-08   8.670E-01   4.842E-08

   COMP     samples are interpreted as COMPLEX  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
 Task:FFT22     User:lwk       Date_Time:Thu Mar 17 16:29:28 2011
     Samp                        16
   Line
      1       9.563E-01   3.792E-08
      2       9.295E-01   4.893E-08
      3       8.670E-01   5.233E-08
      4       7.807E-01   4.835E-08
      5       6.805E-01   2.238E-08
      6       5.815E-01   1.110E-08
      7       4.978E-01  -1.899E-09
      8       4.420E-01  -1.859E-08
      9       4.224E-01   1.490E-08
     10       4.420E-01   7.442E-09
     11       4.978E-01  -1.879E-09
     12       5.815E-01   3.502E-09
     13       6.805E-01   2.238E-08
     14       7.807E-01   4.104E-08
     15       8.670E-01   5.235E-08
     16       9.295E-01   6.780E-08
if ($syschar(1)="UNIX")
  let PATH="/project/test_work/testdata/gll/"
end-if
adespike "/project/test_work/testdata/gll/"s0202556100.sos 6100.spk tol=600
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            0
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                0
adespike "/project/test_work/testdata/gll/"s0202556200.sos xa tol=400
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            1
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                9
adespike xa 6200.spk tol=400
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            1
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                0
adespike "/project/test_work/testdata/gll/"s0202556245.sos  6245.spk tol=400
Beginning VICAR task adespike
ADESPIKE version 21-JUL-95
    TOTAL NUMBER OF PIXELS CORRECTED USING ADJACENT SCAN LINE TEST            2
    TOTAL NUMBER OF PIXELS CORRECTED USING SAME SCAN LINE TEST                3
gllpsf out=psf nl=128 ns=256 filt=GRN
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  GRN
Normalizing by total weight sum of =   1.14158
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:29 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       7.308E-01   3.429E-06   5.522E-07   2.256E-07   1.588E-07   1.389E-07   1.624E-07   2.436E-07   7.290E-07   4.421E-06
     11       8.932E-06   3.003E-06   5.316E-07   2.227E-07   1.584E-07   1.386E-07   1.620E-07   2.406E-07   6.602E-07   3.835E-06
     21       4.872E-06   2.201E-06   4.718E-07   2.151E-07   1.571E-07   1.375E-07   1.606E-07   2.316E-07   5.522E-07   2.755E-06
     31       2.707E-06   1.290E-06   3.786E-07   2.069E-07   1.550E-07   1.358E-07   1.584E-07   2.172E-07   4.525E-07   1.516E-06
     41       1.263E-06   7.486E-07   3.132E-07   1.958E-07   1.521E-07   1.353E-07   1.555E-07   2.054E-07   3.498E-07   8.859E-07
     51       5.955E-07   4.579E-07   2.520E-07   1.823E-07   1.485E-07   1.353E-07   1.518E-07   1.913E-07   2.697E-07   4.953E-07
     61       3.789E-07   3.157E-07   2.193E-07   1.667E-07   1.443E-07   1.353E-07   1.474E-07   1.752E-07   2.308E-07   3.331E-07
     71       4.223E-07   3.372E-07   2.260E-07   1.700E-07   1.452E-07   1.353E-07   1.483E-07   1.786E-07   2.378E-07   3.551E-07
     81       7.290E-07   4.961E-07   2.582E-07   1.852E-07   1.493E-07   1.353E-07   1.526E-07   1.943E-07   2.865E-07   5.348E-07
     91       1.444E-06   8.597E-07   3.273E-07   1.982E-07   1.527E-07   1.353E-07   1.561E-07   2.079E-07   3.646E-07   1.002E-06
    101       2.977E-06   1.425E-06   3.993E-07   2.088E-07   1.555E-07   1.362E-07   1.589E-07   2.205E-07   4.749E-07   1.785E-06
    111       5.414E-06   2.414E-06   4.866E-07   2.164E-07   1.574E-07   1.378E-07   1.610E-07   2.339E-07   5.681E-07   2.939E-06
    121       1.083E-05   3.121E-06   5.389E-07   2.237E-07   1.585E-07   1.387E-07   1.621E-07   2.417E-07   6.848E-07   4.040E-06
copy 6100.spk 6100.soscut (280,320,128,256)
Beginning VICAR task copy
 COPY VERSION 12-JUL-1993
gllpsf filt=VLT out=psf nl=128 ns=256
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  VLT
Normalizing by total weight sum of =   1.25275
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:29 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       8.222E-01   2.467E-06   8.419E-07   3.256E-07   1.842E-07   1.381E-07   1.973E-07   3.683E-07   9.866E-07   3.124E-06
     11       1.069E-05   2.232E-06   8.122E-07   3.188E-07   1.826E-07   1.375E-07   1.957E-07   3.612E-07   9.443E-07   2.686E-06
     21       3.618E-06   1.743E-06   7.259E-07   3.008E-07   1.779E-07   1.355E-07   1.908E-07   3.400E-07   8.419E-07   2.017E-06
     31       1.973E-06   1.340E-06   5.914E-07   2.807E-07   1.702E-07   1.323E-07   1.828E-07   3.058E-07   6.981E-07   1.463E-06
     41       1.316E-06   9.987E-07   4.906E-07   2.538E-07   1.621E-07   1.297E-07   1.720E-07   2.771E-07   5.471E-07   1.083E-06
     51       9.044E-07   7.058E-07   3.882E-07   2.275E-07   1.556E-07   1.270E-07   1.615E-07   2.430E-07   4.236E-07   7.599E-07
     61       5.920E-07   4.945E-07   3.106E-07   2.039E-07   1.479E-07   1.237E-07   1.536E-07   2.168E-07   3.380E-07   5.213E-07
     71       6.545E-07   5.276E-07   3.267E-07   2.088E-07   1.495E-07   1.244E-07   1.552E-07   2.219E-07   3.546E-07   5.552E-07
     81       9.866E-07   7.610E-07   4.029E-07   2.319E-07   1.570E-07   1.276E-07   1.629E-07   2.502E-07   4.494E-07   8.169E-07
     91       1.398E-06   1.067E-06   5.123E-07   2.597E-07   1.632E-07   1.302E-07   1.744E-07   2.833E-07   5.699E-07   1.155E-06
    101       2.220E-06   1.398E-06   6.214E-07   2.853E-07   1.720E-07   1.331E-07   1.847E-07   3.136E-07   7.304E-07   1.512E-06
    111       4.275E-06   1.840E-06   7.473E-07   3.039E-07   1.791E-07   1.360E-07   1.920E-07   3.453E-07   8.649E-07   2.185E-06
    121       1.480E-05   2.285E-06   8.228E-07   3.212E-07   1.832E-07   1.377E-07   1.963E-07   3.637E-07   9.594E-07   2.859E-06
fft22  inp=psf out=otf
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
fft22  inp=6100.soscut out=fftpix nl=128 ns=256
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
Beginning VICAR task wiener
WIENER version Nov 1996
fft22 inp=fixfftpix out=6100.scat mode=inverse format=half
Beginning VICAR task fft22
FFT22 version 1-JUL-94
INVERSE TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
copy 6200.spk 6200.soscut (280,320,128,256)
Beginning VICAR task copy
 COPY VERSION 12-JUL-1993
gllpsf filt=968 out=psf nl=128 ns=256
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  968
Normalizing by total weight sum of =   1.20655
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:29 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       3.329E-01   7.683E-06   1.178E-06   7.888E-07   4.678E-07   3.278E-07   4.951E-07   8.639E-07   1.400E-06   1.195E-05
     11       6.488E-05   6.317E-06   1.170E-06   7.768E-07   4.645E-07   3.258E-07   4.917E-07   8.513E-07   1.294E-06   9.249E-06
     21       1.537E-05   3.892E-06   1.146E-06   7.432E-07   4.548E-07   3.197E-07   4.816E-07   8.141E-07   1.178E-06   5.174E-06
     31       5.037E-06   2.271E-06   1.109E-06   6.964E-07   4.389E-07   3.098E-07   4.651E-07   7.541E-07   1.139E-06   2.697E-06
     41       2.220E-06   1.430E-06   1.014E-06   6.336E-07   4.171E-07   3.054E-07   4.425E-07   6.879E-07   1.067E-06   1.641E-06
     51       1.195E-06   1.141E-06   8.989E-07   5.704E-07   3.900E-07   3.026E-07   4.145E-07   6.082E-07   9.508E-07   1.156E-06
     61       1.110E-06   1.018E-06   7.625E-07   5.114E-07   3.582E-07   2.992E-07   3.816E-07   5.436E-07   8.106E-07   1.043E-06
     71       1.127E-06   1.049E-06   7.907E-07   5.238E-07   3.648E-07   2.999E-07   3.886E-07   5.564E-07   8.398E-07   1.075E-06
     81       1.400E-06   1.156E-06   9.246E-07   5.813E-07   3.958E-07   3.032E-07   4.205E-07   6.252E-07   9.752E-07   1.171E-06
     91       2.561E-06   1.600E-06   1.035E-06   6.473E-07   4.219E-07   3.060E-07   4.475E-07   7.023E-07   1.089E-06   1.819E-06
    101       6.232E-06   2.525E-06   1.118E-06   7.071E-07   4.425E-07   3.121E-07   4.689E-07   7.678E-07   1.148E-06   3.003E-06
    111       1.878E-05   4.259E-06   1.152E-06   7.505E-07   4.573E-07   3.213E-07   4.842E-07   8.234E-07   1.184E-06   5.941E-06
    121       1.024E-04   6.708E-06   1.173E-06   7.811E-07   4.657E-07   3.265E-07   4.929E-07   8.558E-07   1.332E-06   1.040E-05
fft22  inp=psf out=otf
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
fft22  inp=6200.soscut out=fftpix nl=128 ns=256
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
Beginning VICAR task wiener
WIENER version Nov 1996
fft22  inp=fixfftpix out=6200.scat mode=inverse format=half
Beginning VICAR task fft22
FFT22 version 1-JUL-94
INVERSE TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
copy "/project/test_work/testdata/gll/"s0202556245.sos 6245.soscut (280,320,128,256)
Beginning VICAR task copy
 COPY VERSION 12-JUL-1993
gllpsf filt=889 out=psf nl=128 ns=256
Beginning VICAR task gllpsf
GLLPSF version 8-MAR-96
processing filter:  889
Normalizing by total weight sum of =   1.09794
list psf sinc=26 linc=10
Beginning VICAR task list

   REAL     samples are interpreted as  REAL*4  data
 Task:GLLPSF    User:lwk       Date_Time:Thu Mar 17 16:29:29 2011
     Samp             1          27          53          79         105         131         157         183         209         235
   Line
      1       2.908E-01   4.034E-06   1.216E-06   4.090E-07   2.233E-07   1.670E-07   2.345E-07   4.766E-07   1.445E-06   5.816E-06
     11       3.190E-05   3.431E-06   1.169E-06   3.982E-07   2.219E-07   1.662E-07   2.331E-07   4.652E-07   1.377E-06   4.707E-06
     21       7.411E-06   2.645E-06   1.035E-06   3.708E-07   2.179E-07   1.640E-07   2.290E-07   4.317E-07   1.216E-06   3.052E-06
     31       3.002E-06   1.998E-06   8.246E-07   3.451E-07   2.113E-07   1.604E-07   2.221E-07   3.778E-07   9.912E-07   2.233E-06
     41       1.970E-06   1.464E-06   6.678E-07   3.106E-07   2.024E-07   1.574E-07   2.129E-07   3.405E-07   7.557E-07   1.599E-06
     51       1.313E-06   1.003E-06   5.080E-07   2.759E-07   1.912E-07   1.543E-07   2.013E-07   2.967E-07   5.635E-07   1.088E-06
     61       8.255E-07   6.738E-07   3.854E-07   2.435E-07   1.781E-07   1.505E-07   1.878E-07   2.612E-07   4.287E-07   7.156E-07
     71       9.231E-07   7.253E-07   4.108E-07   2.503E-07   1.808E-07   1.513E-07   1.906E-07   2.682E-07   4.548E-07   7.684E-07
     81       1.445E-06   1.089E-06   5.312E-07   2.819E-07   1.936E-07   1.549E-07   2.038E-07   3.060E-07   6.037E-07   1.177E-06
     91       2.158E-06   1.573E-06   7.016E-07   3.181E-07   2.043E-07   1.580E-07   2.149E-07   3.483E-07   7.912E-07   1.713E-06
    101       3.377E-06   2.138E-06   8.714E-07   3.510E-07   2.129E-07   1.612E-07   2.237E-07   3.901E-07   1.042E-06   2.382E-06
    111       9.381E-06   2.791E-06   1.068E-06   3.748E-07   2.189E-07   1.646E-07   2.300E-07   4.401E-07   1.252E-06   3.297E-06
    121       5.441E-05   3.676E-06   1.186E-06   4.021E-07   2.224E-07   1.665E-07   2.336E-07   4.693E-07   1.401E-06   5.061E-06
fft22  inp=psf out=otf
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
fft22  inp=6245.soscut out=fftpix nl=128 ns=256
Beginning VICAR task fft22
FFT22 version 1-JUL-94
FORWARD TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
wiener inp=(fftpix,otf) out=fixfftpix sn=45.
Beginning VICAR task wiener
WIENER version Nov 1996
fft22  inp=fixfftpix out=6245.scat mode=inverse format=half
Beginning VICAR task fft22
FFT22 version 1-JUL-94
INVERSE TRANSFORM
USING SCRATCH FILE: /tmp/fft2scrx.lwk
TRANSFORM COMPLETED
if ($syschar(1)="UNIX")
  ush rm psf.img
  ush rm otf.img
  ush rm *soscut
  ush rm psf
  ush rm fftpix
  ush rm otf
  ush rm fixfftpix
  ush rm *spk
else
end-if
  write "The tester should diplay the input and the output from "
The tester should diplay the input and the output from 
  write "the Ida test as shown below."
the Ida test as shown below.
  write "use xwb0"
use xwb0
  write "vids"
vids
  write "jdisp /project/test_work/testdata/gll/s0202556100.sos"
jdisp /project/test_work/testdata/gll/s0202556100.sos
  write "jdisp 6100.scat"
jdisp 6100.scat
  write "jdisp /project/test_work/testdata/gll/s0202556200.sos"
jdisp /project/test_work/testdata/gll/s0202556200.sos
  write "jdisp 6200.scat"
jdisp 6200.scat
  write "jdisp /project/test_work/testdata/gll/s0202556245.sos"
jdisp /project/test_work/testdata/gll/s0202556245.sos
  write "jdisp 6245.scat"
jdisp 6245.scat
let $echo="no"
exit
slogoff
$ Return
$!#############################################################################
